import{B as Yt,D as te,v as Zt,a as pt,c as Qt,p as ge,s as le,d as _t,T as Ve,I as Ge}from"./chunks/shared.js";import{json as ee,text as U,error as Re}from"@sveltejs/kit";import{HttpError as ne,SvelteKitError as D,Redirect as M,ActionFailure as xe}from"@sveltejs/kit/internal";import{with_request_store as I,merge_tracing as ie,try_get_request_store as er}from"@sveltejs/kit/internal/server";import{a as X,b as z,c as se,r as tr,o as rr,d as Je}from"./chunks/environment.js";import{f as nr,p as Oe,r as Xe,o as sr,s as ar,a as or,g as ir,b as cr}from"./chunks/internal.js";import*as H from"devalue";import{m as lr,d as mt,a as gt,S as dr,v as ur,b as fr,c as hr,e as pr,n as ze,r as Ke,f as _r,g as mr}from"./chunks/exports.js";import{b as Ye,t as gr,a as ae,g as yr}from"./chunks/utils.js";import{r as wr,w as Ze}from"./chunks/index.js";import{parse as ye,serialize as be}from"cookie";import*as Qe from"set-cookie-parser";function yt(){let e,t;return{promise:new Promise((n,s)=>{e=n,t=s}),resolve:e,reject:t}}const $r=[101,103,204,205,304],br=!!globalThis.process?.versions?.webcontainer,kr="/_svelte_kit_assets",wt=["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"],vr=["GET","POST","HEAD"];function Ie(e,t){const r=[];e.split(",").forEach((a,o)=>{const i=/([^/ \t]+)\/([^; \t]+)[ \t]*(?:;[ \t]*q=([0-9.]+))?/.exec(a);if(i){const[,c,u,l="1"]=i;r.push({type:c,subtype:u,q:+l,i:o})}}),r.sort((a,o)=>a.q!==o.q?o.q-a.q:a.subtype==="*"!=(o.subtype==="*")?a.subtype==="*"?1:-1:a.type==="*"!=(o.type==="*")?a.type==="*"?1:-1:a.i-o.i);let n,s=1/0;for(const a of t){const[o,i]=a.split("/"),c=r.findIndex(u=>(u.type===o||u.type==="*")&&(u.subtype===i||u.subtype==="*"));c!==-1&&c<s&&(n=a,s=c)}return n}function Er(e,...t){const r=e.headers.get("content-type")?.split(";",1)[0].trim()??"";return t.includes(r.toLowerCase())}function $t(e){return Er(e,"application/x-www-form-urlencoded","multipart/form-data","text/plain",Yt)}function xr(e){return e instanceof Error||e&&e.name&&e.message?e:new Error(JSON.stringify(e))}function oe(e){return e instanceof ne||e instanceof D?e.status:500}function Rr(e){return e instanceof D?e.text:"Internal Error"}const bt={"&":"&amp;",'"':"&quot;"},kt={"&":"&amp;","<":"&lt;"},vt="[\\ud800-\\udbff](?![\\udc00-\\udfff])|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\udc00-\\udfff]",Sr=new RegExp(`[${Object.keys(bt).join("")}]|`+vt,"g"),jr=new RegExp(`[${Object.keys(kt).join("")}]|`+vt,"g");function Le(e,t){const r=t?bt:kt;return e.replace(t?Sr:jr,s=>s.length===2?s:r[s]??`&#${s.charCodeAt(0)};`)}function Et(e,t){return U(`${t} method not allowed`,{status:405,headers:{allow:Tr(e).join(", ")}})}function Tr(e){const t=wt.filter(r=>r in e);return"GET"in e&&!("HEAD"in e)&&t.push("HEAD"),t}function xt(e){return"__sveltekit_dev"}function ke(e,t,r){let n=e.templates.error({status:t,message:Le(r)});return n=n.replace("</head>",'<script type="module" src="/@vite/client"><\/script></head>'),U(n,{headers:{"content-type":"text/html; charset=utf-8"},status:t})}async function et(e,t,r,n){n=n instanceof ne?n:xr(n);const s=oe(n),a=await W(e,t,r,n),o=Ie(e.request.headers.get("accept")||"text/html",["application/json","text/html"]);return e.isDataRequest||o==="application/json"?ee(a,{status:s}):ke(r,s,a.message)}async function W(e,t,r,n){if(n instanceof ne)return{message:"Unknown Error",...n.body};typeof n=="object"&&nr(n);const s=oe(n),a=Rr(n);return await I({event:e,state:t},()=>r.hooks.handleError({error:n,event:e,status:s,message:a}))??{message:a}}function ve(e,t){return new Response(void 0,{status:e,headers:{location:t}})}function Rt(e,t){return t.path?`Data returned from \`load\` while rendering ${e.route.id} is not serializable: ${t.message} (${t.path}). If you need to serialize/deserialize custom types, use transport hooks: https://svelte.dev/docs/kit/hooks#Universal-hooks-transport.`:t.path===""?`Data returned from \`load\` while rendering ${e.route.id} is not a plain object`:t.message}function St(e){const t={};return e.uses&&e.uses.dependencies.size>0&&(t.dependencies=Array.from(e.uses.dependencies)),e.uses&&e.uses.search_params.size>0&&(t.search_params=Array.from(e.uses.search_params)),e.uses&&e.uses.params.size>0&&(t.params=Array.from(e.uses.params)),e.uses?.parent&&(t.parent=1),e.uses?.route&&(t.route=1),e.uses?.url&&(t.url=1),t}function jt(e,t){return e._.prerendered_routes.has(t)||t.at(-1)==="/"&&e._.prerendered_routes.has(t.slice(0,-1))}function Ar(e,t,r){const n=`
\x1B[1;31m[${e}] ${r.request.method} ${r.url.pathname}\x1B[0m`;return e===404?n:`${n}
${Or(t)}`}let Tt=e=>e;try{const e=await import("node:path"),t=await import("node:process");Tt=r=>e.relative(t.cwd(),r)}catch{}function Or(e){const t=(e.stack?.split(`
`)??[]).map(n=>n.replace(/\((.+)(:\d+:\d+)\)$/,(s,a,o)=>`(${Tt(a)}${o})`)),r=t.findLastIndex(n=>/\(src[\\/]/.test(n));return r===-1?e.stack:t.slice(0,r+1).join(`
`)}function At(e){const r=e?.split("/")?.at(-1);return r?r.split(".").slice(0,-1).join("."):"unknown"}async function qr(e,t,r,n){const s=e.request.method;let a=r[s]||r.fallback;if(s==="HEAD"&&!r.HEAD&&r.GET&&(a=r.GET),!a)return Et(r,s);const o=r.prerender??n.prerender_default;if(o&&(r.POST||r.PATCH||r.PUT||r.DELETE))throw new Error("Cannot prerender endpoints that have mutative methods");if(n.prerendering&&!n.prerendering.inside_reroute&&!o){if(n.depth>0)throw new Error(`${e.route.id} is not prerenderable`);return new Response(void 0,{status:204})}t.is_endpoint_request=!0;try{const i=await I({event:e,state:t},()=>a(e));if(!(i instanceof Response))throw new Error(`Invalid response from route ${e.url.pathname}: handler should return a Response object`);if(n.prerendering&&(!n.prerendering.inside_reroute||o)){const c=new Response(i.clone().body,{status:i.status,statusText:i.statusText,headers:new Headers(i.headers)});if(c.headers.set("x-sveltekit-prerender",String(o)),n.prerendering.inside_reroute&&o)c.headers.set("x-sveltekit-routeid",encodeURI(e.route.id)),n.prerendering.dependencies.set(e.url.pathname,{response:c,body:null});else return c}return i}catch(i){if(i instanceof M)return new Response(void 0,{status:i.status,headers:{location:i.location}});throw i}}function Cr(e){const{method:t,headers:r}=e.request;if(wt.includes(t)&&!vr.includes(t))return!0;if(t==="POST"&&r.get("x-sveltekit-action")==="true")return!1;const n=e.request.headers.get("accept")??"*/*";return Ie(n,["*","text/html"])!=="text/html"}function qe(e){return e.filter(t=>t!=null)}const He="/__data.json",Ee=".html__data.json";function Pr(e){return e.endsWith(He)||e.endsWith(Ee)}function De(e){return e.endsWith(".html")?e.replace(/\.html$/,Ee):e.replace(/\/$/,"")+He}function Nr(e){return e.endsWith(Ee)?e.slice(0,-Ee.length)+".html":e.slice(0,-He.length)}const We="/__route.js";function Ur(e){return e.endsWith(We)}function Ot(e){return e.replace(/\/$/,"")+We}function zr(e){return e.slice(0,-We.length)}const Ir={spanContext(){return Lr},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this},addLink(){return this},addLinks(){return this}},Lr={traceId:"",spanId:"",traceFlags:0};async function re({name:e,attributes:t,fn:r}){return r(Ir)}function qt(e){return Ie(e.request.headers.get("accept")??"*/*",["application/json","text/html"])==="application/json"&&e.request.method==="POST"}async function Hr(e,t,r,n){const s=n?.actions;if(!s){const a=new D(405,"Method Not Allowed",`POST method not allowed. No form actions exist for ${`the page at ${e.route.id}`}`);return de({type:"error",error:await W(e,t,r,a)},{status:a.status,headers:{allow:"GET"}})}Pt(s);try{const a=await Nt(e,t,s);return te&&Ut(a),a instanceof xe?de({type:"failure",status:a.status,data:tt(a.data,e.route.id,r.hooks.transport)}):de({type:"success",status:a?200:204,data:tt(a,e.route.id,r.hooks.transport)})}catch(a){const o=a;return o instanceof M?Ct(o):de({type:"error",error:await W(e,t,r,Me(o))},{status:oe(o)})}}function Me(e){return e instanceof xe?new Error('Cannot "throw fail()". Use "return fail()"'):e}function Ct(e){return de({type:"redirect",status:e.status,location:e.location})}function de(e,t){return ee(e,t)}function Dr(e){return e.request.method==="POST"}async function Wr(e,t,r){const n=r?.actions;if(!n)return e.setHeaders({allow:"GET"}),{type:"error",error:new D(405,"Method Not Allowed",`POST method not allowed. No form actions exist for ${`the page at ${e.route.id}`}`)};Pt(n);try{const s=await Nt(e,t,n);return te&&Ut(s),s instanceof xe?{type:"failure",status:s.status,data:s.data}:{type:"success",status:200,data:s}}catch(s){const a=s;return a instanceof M?{type:"redirect",status:a.status,location:a.location}:{type:"error",error:Me(a)}}}function Pt(e){if(e.default&&Object.keys(e).length>1)throw new Error("When using named actions, the default action cannot be used. See the docs for more info: https://svelte.dev/docs/kit/form-actions#named-actions")}async function Nt(e,t,r){const n=new URL(e.request.url);let s="default";for(const o of n.searchParams)if(o[0].startsWith("/")){if(s=o[0].slice(1),s==="default")throw new Error('Cannot use reserved action name "default"');break}const a=r[s];if(!a)throw new D(404,"Not Found",`No action with name '${s}' found`);if(!$t(e.request))throw new D(415,"Unsupported Media Type",`Form actions expect form-encoded data — received ${e.request.headers.get("content-type")}`);return re({name:"sveltekit.form_action",attributes:{"http.route":e.route.id||"unknown"},fn:async o=>{const i=ie(e,o),c=await I({event:i,state:t},()=>a(i));return c instanceof xe&&o.setAttributes({"sveltekit.form_action.result.type":"failure","sveltekit.form_action.result.status":c.status}),c}})}function Ut(e){if(e instanceof M)throw new Error("Cannot `return redirect(...)` — use `redirect(...)` instead");if(e instanceof ne)throw new Error("Cannot `return error(...)` — use `error(...)` or `return fail(...)` instead")}function Mr(e,t,r){const n=s=>{for(const a in r){const o=r[a].encode(s);if(o)return`app.decode('${a}', ${H.uneval(o,n)})`}};return zt(e,s=>H.uneval(s,n),t)}function tt(e,t,r){const n=Object.fromEntries(Object.entries(r).map(([s,a])=>[s,a.encode]));return zt(e,s=>H.stringify(s,n),t)}function zt(e,t,r){try{return t(e)}catch(n){const s=n;if(e instanceof Response)throw new Error(`Data returned from action inside ${r} is not serializable. Form actions need to return plain objects or fail(). E.g. return { success: true } or return fail(400, { message: "invalid" });`);if("path"in s){let a=`Data returned from action inside ${r} is not serializable: ${s.message}`;throw s.path!==""&&(a+=` (data.${s.path})`),new Error(a)}throw s}}function It(){let e=-1,t=-1;const r=[];return{iterate:(n=s=>s)=>({[Symbol.asyncIterator](){return{next:async()=>{const s=r[++t];if(!s)return{value:null,done:!0};const a=await s.promise;return{value:n(a),done:!1}}}}}),add:n=>{r.push(yt()),n.then(s=>{r[++e].resolve(s)})}}}function ue(e,t,r){let n=1,s=-1;const a=It(),o=xt();function i(u){return function l(f){if(typeof f?.then=="function"){const m=n++,p=f.then(w=>({data:w})).catch(async w=>({error:await W(e,t,r,w)})).then(async({data:w,error:d})=>{let h;try{h=H.uneval(d?[,d]:[w],l)}catch{d=await W(e,t,r,new Error(`Failed to serialize promise while rendering ${e.route.id}`)),w=void 0,h=H.uneval([,d],l)}return{index:u,str:`${o}.resolve(${m}, ${h.includes("app.decode")?`(app) => ${h}`:`() => ${h}`})`}});return a.add(p),`${o}.defer(${m})`}else for(const m in r.hooks.transport){const p=r.hooks.transport[m].encode(f);if(p)return`app.decode('${m}', ${H.uneval(p,l)})`}}}const c=[];return{set_max_nodes(u){s=u},add_node(u,l){try{if(!l){c[u]="null";return}const f={type:"data",data:l.data,uses:St(l)};l.slash&&(f.slash=l.slash),c[u]=H.uneval(f,i(u))}catch(f){throw f.path=f.path.slice(1),new Error(Rt(e,f))}},get_data(u){const l=`<script${u.script_needs_nonce?` nonce="${u.nonce}"`:""}>`,f=`<\/script>
`;return{data:`[${qe(s>-1?c.slice(0,s):c).join(",")}]`,chunks:n>1?a.iterate(({index:m,str:p})=>s>-1&&m>=s?"":l+p+f):null}}}}function Lt(e,t,r){let n=1;const s=It(),a={...Object.fromEntries(Object.entries(r.hooks.transport).map(([i,c])=>[i,c.encode])),Promise:i=>{if(typeof i?.then!="function")return;const c=n++;let u="data";const l=i.catch(async f=>(u="error",W(e,t,r,f))).then(async f=>{let m;try{m=H.stringify(f,a)}catch{const p=await W(e,t,r,new Error(`Failed to serialize promise while rendering ${e.route.id}`));u="error",m=H.stringify(p,a)}return`{"type":"chunk","id":${c},"${u}":${m}}
`});return s.add(l),c}},o=[];return{add_node(i,c){try{if(!c){o[i]="null";return}if(c.type==="error"||c.type==="skip"){o[i]=JSON.stringify(c);return}o[i]=`{"type":"data","data":${H.stringify(c.data,a)},"uses":${JSON.stringify(St(c))}${c.slash?`,"slash":${JSON.stringify(c.slash)}`:""}}`}catch(u){throw u.path="data"+u.path,new Error(Rt(e,u))}},get_data(){return{data:`{"type":"data","nodes":[${o.join(",")}]}
`,chunks:n>1?s.iterate():null}}}}async function Fe({event:e,event_state:t,state:r,node:n,parent:s}){if(!n?.server)return null;let a=!0;const o={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},i=n.server.load,c=n.server.trailingSlash;if(!i)return{type:"data",data:null,uses:o,slash:c};const u=lr(e.url,()=>{l&&!o.url&&console.warn(`${n.server_id}: Accessing URL properties in a promise handler after \`load(...)\` has returned will not cause the function to re-run when the URL changes`),a&&(o.url=!0)},m=>{l&&!o.search_params.has(m)&&console.warn(`${n.server_id}: Accessing URL properties in a promise handler after \`load(...)\` has returned will not cause the function to re-run when the URL changes`),a&&o.search_params.add(m)});r.prerendering&&mt(u);let l=!1;const f=await re({name:"sveltekit.load",attributes:{"sveltekit.load.node_id":n.server_id||"unknown","sveltekit.load.node_type":At(n.server_id),"http.route":e.route.id||"unknown"},fn:async m=>{const p=ie(e,m);return await I({event:p,state:t},()=>i.call(null,{...p,fetch:(d,h)=>{const g=new URL(d instanceof Request?d.url:d,e.url);return l&&!o.dependencies.has(g.href)&&console.warn(`${n.server_id}: Calling \`event.fetch(...)\` in a promise handler after \`load(...)\` has returned will not cause the function to re-run when the dependency is invalidated`),e.fetch(d,h)},depends:(...d)=>{for(const h of d){const{href:g}=new URL(h,e.url);Zt(n.server_id||"missing route ID",h),l&&!o.dependencies.has(g)&&console.warn(`${n.server_id}: Calling \`depends(...)\` in a promise handler after \`load(...)\` has returned will not cause the function to re-run when the dependency is invalidated`),o.dependencies.add(g)}},params:new Proxy(e.params,{get:(d,h)=>(l&&typeof h=="string"&&!o.params.has(h)&&console.warn(`${n.server_id}: Accessing \`params.${String(h)}\` in a promise handler after \`load(...)\` has returned will not cause the function to re-run when the param changes`),a&&o.params.add(h),d[h])}),parent:async()=>(l&&!o.parent&&console.warn(`${n.server_id}: Calling \`parent(...)\` in a promise handler after \`load(...)\` has returned will not cause the function to re-run when parent data changes`),a&&(o.parent=!0),s()),route:new Proxy(e.route,{get:(d,h)=>(l&&typeof h=="string"&&!o.route&&console.warn(`${n.server_id}: Accessing \`route.${String(h)}\` in a promise handler after \`load(...)\` has returned will not cause the function to re-run when the route changes`),a&&(o.route=!0),d[h])}),url:u,untrack(d){a=!1;try{return d()}finally{a=!0}}}))}});return pt(f,`in ${n.server_id}`),l=!0,{type:"data",data:f??null,uses:o,slash:c}}async function Ht({event:e,event_state:t,fetched:r,node:n,parent:s,server_data_promise:a,state:o,resolve_opts:i,csr:c}){const u=await a,l=n?.universal?.load;if(!l)return u?.data??null;const f=await re({name:"sveltekit.load",attributes:{"sveltekit.load.node_id":n.universal_id||"unknown","sveltekit.load.node_type":At(n.universal_id),"http.route":e.route.id||"unknown"},fn:async m=>{const p=ie(e,m);return await I({event:p,state:t},()=>l.call(null,{url:e.url,params:e.params,data:u?.data??null,route:e.route,fetch:Fr(e,o,r,c,i),setHeaders:e.setHeaders,depends:()=>{},parent:s,untrack:w=>w(),tracing:p.tracing}))}});return pt(f,`in ${n.universal_id}`),f??null}function Fr(e,t,r,n,s){const a=async(o,i)=>{const c=o instanceof Request&&o.body?o.clone().body:null,u=o instanceof Request&&[...o.headers].length?new Headers(o.headers):i?.headers;let l=await e.fetch(o,i);const f=new URL(o instanceof Request?o.url:o,e.url),m=f.origin===e.url.origin;let p;if(m)t.prerendering&&(p={response:l,body:null},t.prerendering.dependencies.set(f.pathname,p));else if(f.protocol==="https:"||f.protocol==="http:")if((o instanceof Request?o.mode:i?.mode??"cors")==="no-cors")l=new Response("",{status:l.status,statusText:l.statusText,headers:l.headers});else{const g=l.headers.get("access-control-allow-origin");if(!g||g!==e.url.origin&&g!=="*")throw new Error(`CORS error: ${g?"Incorrect":"No"} 'Access-Control-Allow-Origin' header is present on the requested resource`)}let w;const d=new Proxy(l,{get(h,g,b){async function R(_,$){const y=Number(h.status);if(isNaN(y))throw new Error(`response.status is not a number. value: "${h.status}" type: ${typeof h.status}`);r.push({url:m?f.href.slice(e.url.origin.length):f.href,method:e.request.method,request_body:o instanceof Request&&c?await Br(c):i?.body,request_headers:u,response_body:_,response:h,is_b64:$})}if(g==="body"){if(h.body===null)return null;if(w)return w;const[_,$]=h.body.tee();return(async()=>{let y=new Uint8Array;for await(const k of _){const E=new Uint8Array(y.length+k.length);E.set(y,0),E.set(k,y.length),y=E}p&&(p.body=new Uint8Array(y)),R(Ye(y),!0)})(),w=$}if(g==="arrayBuffer")return async()=>{const _=await h.arrayBuffer(),$=new Uint8Array(_);return p&&(p.body=$),_ instanceof ArrayBuffer&&await R(Ye($),!0),_};async function v(){const _=await h.text();if(_===""&&$r.includes(h.status)){await R(void 0,!1);return}return(!_||typeof _=="string")&&await R(_,!1),p&&(p.body=_),_}if(g==="text")return v;if(g==="json")return async()=>{const _=await v();return _?JSON.parse(_):void 0};const j=Reflect.get(h,g,h);return j instanceof Function?Object.defineProperties(function(){return Reflect.apply(j,this===b?h:this,arguments)},{name:{value:j.name},length:{value:j.length}}):j}});if(n){const h=l.headers.get;l.headers.get=g=>{const b=g.toLowerCase(),R=h.call(l.headers,b);if(R&&!b.startsWith("x-sveltekit-")&&!s.filterSerializedResponseHeaders(b,R))throw new Error(`Failed to get response header "${b}" — it must be included by the \`filterSerializedResponseHeaders\` option: https://svelte.dev/docs/kit/hooks#Server-hooks-handle (at ${e.route.id})`);return R}}return d};return(o,i)=>{const c=a(o,i);return c.catch(()=>{}),c}}async function Br(e){let t="";const r=e.getReader();for(;;){const{done:n,value:s}=await r.read();if(n)break;t+=gr.decode(s)}return t}function Dt(...e){let t=5381;for(const r of e)if(typeof r=="string"){let n=r.length;for(;n;)t=t*33^r.charCodeAt(--n)}else if(ArrayBuffer.isView(r)){const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);let s=n.length;for(;s;)t=t*33^n[--s]}else throw new TypeError("value must be a string or TypedArray");return(t>>>0).toString(36)}const Wt={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},Vr=new RegExp(`[${Object.keys(Wt).join("")}]`,"g");function Gr(e,t,r=!1){const n={};let s=null,a=null,o=!1;for(const[l,f]of e.response.headers)t(l,f)&&(n[l]=f),l==="cache-control"?s=f:l==="age"?a=f:l==="vary"&&f.trim()==="*"&&(o=!0);const i={status:e.response.status,statusText:e.response.statusText,headers:n,body:e.response_body},c=JSON.stringify(i).replace(Vr,l=>Wt[l]),u=['type="application/json"',"data-sveltekit-fetched",`data-url="${Le(e.url,!0)}"`];if(e.is_b64&&u.push("data-b64"),e.request_headers||e.request_body){const l=[];e.request_headers&&l.push([...new Headers(e.request_headers)].join(",")),e.request_body&&l.push(e.request_body),u.push(`data-hash="${Dt(...l)}"`)}if(!r&&e.method==="GET"&&s&&!o){const l=/s-maxage=(\d+)/g.exec(s)??/max-age=(\d+)/g.exec(s);if(l){const f=+l[1]-+(a??"0");u.push(`data-ttl="${f}"`)}}return`<script ${u.join(" ")}>${c}<\/script>`}const L=JSON.stringify;function rt(e){Ce[0]||Jr();const t=Mt.slice(0),r=Xr(e);for(let s=0;s<r.length;s+=16){const a=r.subarray(s,s+16);let o,i,c,u=t[0],l=t[1],f=t[2],m=t[3],p=t[4],w=t[5],d=t[6],h=t[7];for(let g=0;g<64;g++)g<16?o=a[g]:(i=a[g+1&15],c=a[g+14&15],o=a[g&15]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+a[g&15]+a[g+9&15]|0),o=o+h+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(d^p&(w^d))+Ce[g],h=d,d=w,w=p,p=m+o|0,m=f,f=l,l=u,u=o+(l&f^m&(l^f))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;t[0]=t[0]+u|0,t[1]=t[1]+l|0,t[2]=t[2]+f|0,t[3]=t[3]+m|0,t[4]=t[4]+p|0,t[5]=t[5]+w|0,t[6]=t[6]+d|0,t[7]=t[7]+h|0}const n=new Uint8Array(t.buffer);return Ft(n),btoa(String.fromCharCode(...n))}const Mt=new Uint32Array(8),Ce=new Uint32Array(64);function Jr(){function e(r){return(r-Math.floor(r))*4294967296}let t=2;for(let r=0;r<64;t++){let n=!0;for(let s=2;s*s<=t;s++)if(t%s===0){n=!1;break}n&&(r<8&&(Mt[r]=e(t**(1/2))),Ce[r]=e(t**(1/3)),r++)}}function Ft(e){for(let t=0;t<e.length;t+=4){const r=e[t+0],n=e[t+1],s=e[t+2],a=e[t+3];e[t+0]=a,e[t+1]=s,e[t+2]=n,e[t+3]=r}}function Xr(e){const t=ae.encode(e),r=t.length*8,n=512*Math.ceil((r+65)/512),s=new Uint8Array(n/8);s.set(t),s[t.length]=128,Ft(s);const a=new Uint32Array(s.buffer);return a[a.length-2]=Math.floor(r/4294967296),a[a.length-1]=r,a}const nt=new Uint8Array(16);function Kr(){return crypto.getRandomValues(nt),btoa(String.fromCharCode(...nt))}const Yr=new Set(["self","unsafe-eval","unsafe-hashes","unsafe-inline","none","strict-dynamic","report-sample","wasm-unsafe-eval","script"]),Zr=/^(nonce|sha\d\d\d)-/;class Bt{#e;#t;#c;#l;#d;#f;#h;#p;#n;#s;#a;#o;#i;#r;#u;constructor(t,r,n){this.#e=t,this.#n={...r};const s=this.#n;this.#s=[],this.#a=[],this.#o=[],this.#i=[],this.#r=[];const a=s["script-src"]||s["default-src"],o=s["script-src-elem"],i=s["style-src"]||s["default-src"],c=s["style-src-attr"],u=s["style-src-elem"];i&&!i.includes("unsafe-inline")&&(s["style-src"]=[...i.filter(f=>!(f.startsWith("sha256-")||f.startsWith("nonce-"))),"unsafe-inline"]),c&&!c.includes("unsafe-inline")&&(s["style-src-attr"]=[...c.filter(f=>!(f.startsWith("sha256-")||f.startsWith("nonce-"))),"unsafe-inline"]),u&&!u.includes("unsafe-inline")&&(s["style-src-elem"]=[...u.filter(f=>!(f.startsWith("sha256-")||f.startsWith("nonce-"))),"unsafe-inline"]);const l=f=>!!f&&!f.some(m=>m==="unsafe-inline");this.#c=l(a),this.#l=l(o),this.#f=l(i),this.#h=l(c),this.#p=l(u),this.#t=this.#c||this.#l,this.#d=!te,this.script_needs_nonce=this.#t&&!this.#e,this.style_needs_nonce=this.#d&&!this.#e,this.#u=n}add_script(t){if(!this.#t)return;const r=this.#e?`sha256-${rt(t)}`:`nonce-${this.#u}`;this.#c&&this.#s.push(r),this.#l&&this.#a.push(r)}add_style(t){if(!this.#d)return;const r=this.#e?`sha256-${rt(t)}`:`nonce-${this.#u}`;if(this.#f&&this.#o.push(r),this.#h&&this.#i.push(r),this.#p){const n="sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=",s=this.#n;s["style-src-elem"]&&!s["style-src-elem"].includes(n)&&!this.#r.includes(n)&&this.#r.push(n),r!==n&&this.#r.push(r)}}get_header(t=!1){const r=[],n={...this.#n};this.#o.length>0&&(n["style-src"]=[...n["style-src"]||n["default-src"]||[],...this.#o]),this.#i.length>0&&(n["style-src-attr"]=[...n["style-src-attr"]||[],...this.#i]),this.#r.length>0&&(n["style-src-elem"]=[...n["style-src-elem"]||[],...this.#r]),this.#s.length>0&&(n["script-src"]=[...n["script-src"]||n["default-src"]||[],...this.#s]),this.#a.length>0&&(n["script-src-elem"]=[...n["script-src-elem"]||[],...this.#a]);for(const s in n){if(t&&(s==="frame-ancestors"||s==="report-uri"||s==="sandbox"))continue;const a=n[s];if(!a)continue;const o=[s];Array.isArray(a)&&a.forEach(i=>{Yr.has(i)||Zr.test(i)?o.push(`'${i}'`):o.push(i)}),r.push(o.join(" "))}return r.join("; ")}}class Qr extends Bt{get_meta(){const t=this.get_header(!0);if(t)return`<meta http-equiv="content-security-policy" content="${Le(t,!0)}">`}}class en extends Bt{constructor(t,r,n){if(super(t,r,n),Object.values(r).filter(s=>!!s).length>0){const s=r["report-to"]?.length??!1,a=r["report-uri"]?.length??!1;if(!s&&!a)throw Error("`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both")}}}class tn{nonce=Kr();csp_provider;report_only_provider;constructor({mode:t,directives:r,reportOnly:n},{prerender:s}){const a=t==="hash"||t==="auto"&&s;this.csp_provider=new Qr(a,r,this.nonce),this.report_only_provider=new en(a,n,this.nonce)}get script_needs_nonce(){return this.csp_provider.script_needs_nonce||this.report_only_provider.script_needs_nonce}get style_needs_nonce(){return this.csp_provider.style_needs_nonce||this.report_only_provider.style_needs_nonce}add_script(t){this.csp_provider.add_script(t),this.report_only_provider.add_script(t)}add_style(t){this.csp_provider.add_style(t),this.report_only_provider.add_style(t)}}function Vt(e,t,r){const n={},s=e.slice(1),a=s.filter(i=>i!==void 0);let o=0;for(let i=0;i<t.length;i+=1){const c=t[i];let u=s[i-o];if(c.chained&&c.rest&&o&&(u=s.slice(i-o,i+1).filter(l=>l).join("/"),o=0),u===void 0){c.rest&&(n[c.name]="");continue}if(!c.matcher||r[c.matcher](u)){n[c.name]=u;const l=t[i+1],f=s[i+1];l&&!l.rest&&l.optional&&f&&c.chained&&(o=0),!l&&!f&&Object.keys(n).length===a.length&&(o=0);continue}if(c.optional&&c.chained){o++;continue}return}if(!o)return n}function Gt(e,t,r){const{errors:n,layouts:s,leaf:a}=e,o=[...n,...s.map(i=>i?.[1]),a[1]].filter(i=>typeof i=="number").map(i=>`'${i}': () => ${Jt(r._.client.nodes?.[i],t)}`).join(`,
		`);return[`{
	id: ${L(e.id)}`,`errors: ${L(e.errors)}`,`layouts: ${L(e.layouts)}`,`leaf: ${L(e.leaf)}`,`nodes: {
		${o}
	}
}`].join(`,
	`)}function Jt(e,t){if(!e)return"Promise.resolve({})";if(e[0]==="/")return`import('${e}')`;if(X!=="")return`import('${X}/${e}')`;let r=yr(t.pathname,`${z}/${e}`);return r[0]!=="."&&(r=`./${r}`),`import('${r}')`}async function rn(e,t,r){if(!r._.client.routes)return U("Server-side route resolution disabled",{status:400});let n=null,s={};const a=await r._.matchers();for(const o of r._.client.routes){const i=o.pattern.exec(e);if(!i)continue;const c=Vt(i,o.params,a);if(c){n=o,s=gt(c);break}}return Xt(n,s,t,r).response}function Xt(e,t,r,n){const s=new Headers({"content-type":"application/javascript; charset=utf-8"});if(e){const a=Gt(e,r,n),o=`${nn(e,r,n)}
export const route = ${a}; export const params = ${JSON.stringify(t)};`;return{response:U(o,{headers:s}),body:o}}else return{response:U("",{headers:s}),body:""}}function nn(e,t,r){const{errors:n,layouts:s,leaf:a}=e;let o="";for(const i of[...n,...s.map(c=>c?.[1]),a[1]]){if(typeof i!="number")continue;const c=r._.client.css?.[i];for(const u of c??[])o+=`'${X||z}/${u}',`}return o?`${Jt(r._.client.start,t)}.then(x => x.load_css([${o}]));`:""}const sn={...wr(!1),check:()=>!1};async function fe({branch:e,fetched:t,options:r,manifest:n,state:s,page_config:a,status:o,error:i=null,event:c,event_state:u,resolve_opts:l,action_result:f,data_serializer:m}){if(s.prerendering){if(r.csp.mode==="nonce")throw new Error('Cannot use prerendering if config.kit.csp.mode === "nonce"');if(r.app_template_contains_nonce)throw new Error("Cannot use prerendering if page template contains %sveltekit.nonce%")}const{client:p}=n._,w=new Set(p.imports),d=new Set(p.stylesheets),h=new Set(p.fonts),g=new Set,b=new Set,R=new Map;let v;const j=f?.type==="success"||f?.type==="failure"?f.data??null:null;let _=z,$=X,y=L(z);if(s.prerendering?.fallback?r.hash_routing&&(y="new URL('.', location).pathname.slice(0, -1)"):(_=c.url.pathname.slice(z.length).split("/").slice(2).map(()=>"..").join("/")||".",y=`new URL(${L(_)}, location).pathname.slice(0, -1)`,(!X||X[0]==="/"&&X!==kr)&&($=_)),a.ssr){const S={stores:{page:Ze(null),navigating:Ze(null),updated:sn},constructors:await Promise.all(e.map(({node:q})=>{if(!q.component)throw new Error(`Missing +page.svelte component for route ${c.route.id}`);return q.component()})),form:j};let A={};for(let q=0;q<e.length;q+=1)A={...A,...e[q].data},S[`data_${q}`]=A;S.page={error:i,params:c.params,route:c.route,status:o,url:c.url,data:A,form:j,state:{}};const V={context:new Map([["__request__",{page:S.page}]])},Z=globalThis.fetch;try{if(te){let q=!1;globalThis.fetch=(N,J)=>{if(typeof N=="string"&&!dr.test(N))throw new Error(`Cannot call \`fetch\` eagerly during server-side rendering with relative URL (${N}) — put your \`fetch\` calls inside \`onMount\` or a \`load\` function instead`);return!q&&!er()?.state.is_in_remote_function&&(console.warn("Avoid calling `fetch` eagerly during server-side rendering — put your `fetch` calls inside `onMount` or a `load` function instead"),q=!0),Z(N,J)}}v=await I({event:c,state:u},async()=>{tr&&rr({base:_,assets:$});const q=r.root.render(S,V),N=r.async&&"then"in q?q.then(O=>O):q;r.async&&Je();const{head:J,html:_e,css:me}=r.async?await N:N;return{head:J,html:_e,css:me}})}finally{globalThis.fetch=Z,Je()}for(const{node:q}of e){for(const N of q.imports)w.add(N);for(const N of q.stylesheets)d.add(N);for(const N of q.fonts)h.add(N);q.inline_styles&&!p.inline&&Object.entries(await q.inline_styles()).forEach(([N,J])=>R.set(N,J))}}else v={head:"",html:"",css:{code:"",map:null}};let k="",E=v.html;const x=new tn(r.csp,{prerender:!!s.prerendering}),T=S=>S.startsWith("/")?z+S:`${$}/${S}`,C=p.inline?p.inline?.style:Array.from(R.values()).join(`
`);if(C){const S=[" data-sveltekit"];x.style_needs_nonce&&S.push(` nonce="${x.nonce}"`),x.add_style(C),k+=`
	<style${S.join("")}>${C}</style>`}for(const S of d){const A=T(S),V=['rel="stylesheet"'];R.has(S)?V.push("disabled",'media="(max-width: 0)"'):l.preload({type:"css",path:A})&&g.add(`<${encodeURI(A)}>; rel="preload"; as="style"; nopush`),k+=`
		<link href="${A}" ${V.join(" ")}>`}for(const S of h){const A=T(S);if(l.preload({type:"font",path:A})){const V=S.slice(S.lastIndexOf(".")+1);b.add(`<link rel="preload" as="font" type="font/${V}" href="${A}" crossorigin>`),g.add(`<${encodeURI(A)}>; rel="preload"; as="font"; type="font/${V}"; crossorigin; nopush`)}}const F=xt(),{data:B,chunks:G}=m.get_data(x);if(a.ssr&&a.csr&&(E+=`
			${t.map(S=>Gr(S,l.filterSerializedResponseHeaders,!!s.prerendering)).join(`
			`)}`),a.csr){const S=n._.client.routes?.find(O=>O.id===c.route.id)??null;if(p.uses_env_dynamic_public&&s.prerendering&&w.add(`${se}/env.js`),!p.inline){const O=Array.from(w,P=>T(P)).filter(P=>l.preload({type:"js",path:P}));for(const P of O)g.add(`<${encodeURI(P)}>; rel="modulepreload"; nopush`),r.preload_strategy!=="modulepreload"?k+=`
		<link rel="preload" as="script" crossorigin="anonymous" href="${P}">`:b.add(`<link rel="modulepreload" href="${P}">`)}if(s.prerendering&&b.size>0&&(k+=Array.from(b).map(O=>`
		${O}`).join("")),n._.client.routes&&s.prerendering&&!s.prerendering.fallback){const O=Ot(c.url.pathname);s.prerendering.dependencies.set(O,Xt(S,c.params,new URL(O,c.url),n))}const A=[],V=p.uses_env_dynamic_public&&s.prerendering,Z=[`base: ${y}`];if(X&&Z.push(`assets: ${L(X)}`),p.uses_env_dynamic_public&&Z.push(`env: ${V?"null":L(Oe)}`),G){A.push("const deferred = new Map();"),Z.push(`defer: (id) => new Promise((fulfil, reject) => {
							deferred.set(id, { fulfil, reject });
						})`);let O="";Object.keys(r.hooks.transport).length>0&&(p.inline?O=`const app = __sveltekit_${r.version_hash}.app.app;`:p.app?O=`const app = await import(${L(T(p.app))});`:O=`const { app } = await import(${L(T(p.start))});`);const P=O?`${O}
							const [data, error] = fn(app);`:"const [data, error] = fn();";Z.push(`resolve: async (id, fn) => {
							${P}

							const try_to_resolve = () => {
								if (!deferred.has(id)) {
									setTimeout(try_to_resolve, 0);
									return;
								}
								const { fulfil, reject } = deferred.get(id);
								deferred.delete(id);
								if (error) reject(error);
								else fulfil(data);
							}
							try_to_resolve();
						}`)}A.push(`${F} = {
						${Z.join(`,
						`)}
					};`);const q=["element"];if(A.push("const element = document.currentScript.parentElement;"),a.ssr){const O={form:"null",error:"null"};j&&(O.form=Mr(j,c.route.id,r.hooks.transport)),i&&(O.error=H.uneval(i));const P=[`node_ids: [${e.map(({node:Y})=>Y.index).join(", ")}]`,`data: ${B}`,`form: ${O.form}`,`error: ${O.error}`];if(o!==200&&P.push(`status: ${o}`),n._.client.routes){if(S){const Y=Gt(S,c.url,n).replaceAll(`
`,`
							`);P.push(`params: ${H.uneval(c.params)}`,`server_route: ${Y}`)}}else r.embedded&&P.push(`params: ${H.uneval(c.params)}`,`route: ${L(c.route)}`);const Q="	".repeat(V?7:6);q.push(`{
${Q}	${P.join(`,
${Q}	`)}
${Q}}`)}const{remote_data:N}=u;let J="";if(N){const O={};for(const[Q,Y]of N)if(Q.id)for(const ce in Y)O[Qt(Q.id,ce)]=await Y[ce];const P=Q=>{for(const Y in r.hooks.transport){const ce=r.hooks.transport[Y].encode(Q);if(ce)return`app.decode('${Y}', ${H.uneval(ce,P)})`}};J=`${F}.data = ${H.uneval(O,P)};

						`}const _e=p.inline?`${p.inline.script}

					${J}${F}.app.start(${q.join(", ")});`:p.app?`Promise.all([
						import(${L(T(p.start))}),
						import(${L(T(p.app))})
					]).then(([kit, app]) => {
						${J}kit.start(app, ${q.join(", ")});
					});`:`import(${L(T(p.start))}).then((app) => {
						${J}app.start(${q.join(", ")})
					});`;if(V?A.push(`import(${L(`${_}/${se}/env.js`)}).then(({ env }) => {
						${F}.env = env;

						${_e.replace(/\n/g,`
	`)}
					});`):A.push(_e),r.service_worker){let O=", { type: 'module' }";if(r.service_worker_options!=null){const P={...r.service_worker_options};P.type="module",O=`, ${L(P)}`}A.push(`if ('serviceWorker' in navigator) {
						addEventListener('load', function () {
							navigator.serviceWorker.register('${T("service-worker.js")}'${O});
						});
					}`)}const me=`
				{
					${A.join(`

					`)}
				}
			`;x.add_script(me),E+=`
			<script${x.script_needs_nonce?` nonce="${x.nonce}"`:""}>${me}<\/script>
		`}const K=new Headers({"x-sveltekit-page":"true","content-type":"text/html"});if(s.prerendering){const S=[],A=x.csp_provider.get_meta();A&&S.push(A),s.prerendering.cache&&S.push(`<meta http-equiv="cache-control" content="${s.prerendering.cache}">`),S.length>0&&(k=S.join(`
`)+k)}else{const S=x.csp_provider.get_header();S&&K.set("content-security-policy",S);const A=x.report_only_provider.get_header();A&&K.set("content-security-policy-report-only",A),g.size&&K.set("link",Array.from(g).join(", "))}k+=v.head;const he=r.templates.app({head:k,body:E,assets:$,nonce:x.nonce,env:Oe}),pe=await l.transformPageChunk({html:he,done:!0})||"";return G||K.set("etag",`"${Dt(pe)}"`),a.csr?pe.split("<!--").length<he.split("<!--").length&&console.warn("\x1B[1m\x1B[31mRemoving comments in transformPageChunk can break Svelte's hydration\x1B[39m\x1B[22m"):G&&console.warn("\x1B[1m\x1B[31mReturning promises from server `load` functions will only work if `csr === true`\x1B[39m\x1B[22m"),G?new Response(new ReadableStream({async start(S){S.enqueue(ae.encode(pe+`
`));for await(const A of G)A.length&&S.enqueue(ae.encode(A));S.close()},type:"bytes"}),{headers:K}):U(pe,{status:o,headers:K})}class Be{data;constructor(t){this.data=t}layouts(){return this.data.slice(0,-1)}page(){return this.data.at(-1)}validate(){for(const r of this.layouts())r&&(ur(r.server,r.server_id),fr(r.universal,r.universal_id));const t=this.page();t&&(hr(t.server,t.server_id),pr(t.universal,t.universal_id))}#e(t){return this.data.reduce((r,n)=>n?.universal?.[t]??n?.server?.[t]??r,void 0)}csr(){return this.#e("csr")??!0}ssr(){return this.#e("ssr")??!0}prerender(){return this.#e("prerender")??!1}trailing_slash(){return this.#e("trailingSlash")??"never"}get_config(){let t={};for(const r of this.data)!r?.universal?.config&&!r?.server?.config||(t={...t,...r?.universal?.config,...r?.server?.config});return Object.keys(t).length?t:void 0}should_prerender_data(){return this.data.some(t=>t?.server?.load||t?.server?.trailingSlash!==void 0)}}async function Kt({event:e,event_state:t,options:r,manifest:n,state:s,status:a,error:o,resolve_opts:i}){if(e.request.headers.get("x-sveltekit-error"))return ke(r,a,o.message);const c=[];try{const u=[],l=await n._.nodes[0](),f=new Be([l]),m=f.ssr(),p=f.csr(),w=ue(e,t,r);if(m){s.error=!0;const d=Fe({event:e,event_state:t,state:s,node:l,parent:async()=>({})}),h=await d;w.add_node(0,h);const g=await Ht({event:e,event_state:t,fetched:c,node:l,parent:async()=>({}),resolve_opts:i,server_data_promise:d,state:s,csr:p});u.push({node:l,server_data:h,data:g},{node:await n._.nodes[1](),data:null,server_data:null})}return await fe({options:r,manifest:n,state:s,page_config:{ssr:m,csr:p},status:a,error:await W(e,t,r,o),branch:u,fetched:c,event:e,event_state:t,resolve_opts:i,data_serializer:w})}catch(u){return u instanceof M?ve(u.status,u.location):ke(r,oe(u),(await W(e,t,r,u)).message)}}async function an(e,t,r,n,s){return re({name:"sveltekit.remote.call",attributes:{},fn:a=>{const o=ie(e,a);return I({event:o,state:t},()=>on(o,t,r,n,s))}})}async function on(e,t,r,n,s){const[a,o,i]=s.split("/"),c=n._.remotes;c[a]||Re(404);const l=(await c[a]()).default[o];l||Re(404);const f=l.__,m=r.hooks.transport;e.tracing.current.setAttributes({"sveltekit.remote.call.type":f.type,"sveltekit.remote.call.name":f.name});let p;try{if(f.type==="query_batch"){if(e.request.method!=="POST")throw new D(405,"Method Not Allowed",`\`query.batch\` functions must be invoked via POST request, not ${e.request.method}`);const{payloads:g}=await e.request.json(),b=g.map(j=>ge(j,m)),R=await I({event:e,state:t},()=>f.run(b)),v=await Promise.all(b.map(async(j,_)=>{try{return{type:"result",data:R(j,_)}}catch($){return{type:"error",error:await W(e,t,r,$),status:$ instanceof ne||$ instanceof D?$.status:500}}}));return ee({type:"result",result:le(v,m)})}if(f.type==="form"){if(e.request.method!=="POST")throw new D(405,"Method Not Allowed",`\`form\` functions must be invoked via POST request, not ${e.request.method}`);if(!$t(e.request))throw new D(415,"Unsupported Media Type",`\`form\` functions expect form-encoded data — received ${e.request.headers.get("content-type")}`);const{data:g,meta:b,form_data:R}=await _t(e.request);i&&!("id"in g)&&(g.id=JSON.parse(decodeURIComponent(i)));const v=f.fn,j=await I({event:e,state:t},()=>v(g,b,R));return ee({type:"result",result:le(j,m),refreshes:j.issues?void 0:await w(b.remote_refreshes)})}if(f.type==="command"){const{payload:g,refreshes:b}=await e.request.json(),R=ge(g,m),v=await I({event:e,state:t},()=>l(R));return ee({type:"result",result:le(v,m),refreshes:await w(b)})}const d=f.type==="prerender"?i:new URL(e.request.url).searchParams.get("payload"),h=await I({event:e,state:t},()=>l(ge(d,m)));return ee({type:"result",result:le(h,m)})}catch(d){if(d instanceof M)return ee({type:"redirect",location:d.location,refreshes:await w(p)});const h=d instanceof ne||d instanceof D?d.status:500;return ee({type:"error",error:await W(e,t,r,d),status:h},{status:t.prerendering?h:void 0,headers:{"cache-control":"private, no-store"}})}async function w(d){const h=t.refreshes??{};if(d)for(const g of d){if(h[g]!==void 0)continue;const[b,R,v]=g.split("/"),j=n._.remotes[b],_=(await j?.())?.default?.[R];_||Re(400,"Bad Request"),h[g]=I({event:e,state:t},()=>_(ge(v,m)))}if(Object.keys(h).length!==0)return le(Object.fromEntries(await Promise.all(Object.entries(h).map(async([g,b])=>[g,await b]))),m)}}async function cn(e,t,r,n){return re({name:"sveltekit.remote.form.post",attributes:{},fn:s=>{const a=ie(e,s);return I({event:a,state:t},()=>ln(a,t,r,n))}})}async function ln(e,t,r,n){const[s,a,o]=n.split("/");let u=(await r._.remotes[s]?.())?.default[a];if(!u)return e.setHeaders({allow:"GET"}),{type:"error",error:new D(405,"Method Not Allowed",`POST method not allowed. No form actions exist for ${`the page at ${e.route.id}`}`)};o&&(u=I({event:e,state:t},()=>u.for(JSON.parse(o))));try{const l=u.__.fn,{data:f,meta:m,form_data:p}=await _t(e.request);return o&&!("id"in f)&&(f.id=JSON.parse(decodeURIComponent(o))),await I({event:e,state:t},()=>l(f,m,p)),{type:"success",status:200}}catch(l){const f=l;return f instanceof M?{type:"redirect",status:f.status,location:f.location}:{type:"error",error:Me(f)}}}function dn(e){return e.pathname.startsWith(`${z}/${se}/remote/`)&&e.pathname.replace(`${z}/${se}/remote/`,"")}function un(e){return e.searchParams.get("/remote")}const fn=10;async function hn(e,t,r,n,s,a,o,i){if(a.depth>fn)return U(`Not found: ${e.url.pathname}`,{status:404});if(qt(e)){const c=await s._.nodes[r.leaf]();return Hr(e,t,n,c?.server)}try{const c=o.page();let u=200,l;if(Dr(e)){const $=un(e.url);if($?l=await cn(e,t,s,$):l=await Wr(e,t,c.server),l?.type==="redirect")return ve(l.status,l.location);l?.type==="error"&&(u=oe(l.error)),l?.type==="failure"&&(u=l.status)}const f=o.prerender();if(f){if(c.server?.actions)throw new Error("Cannot prerender pages with actions")}else if(a.prerendering)return new Response(void 0,{status:204});a.prerender_default=f;const m=o.should_prerender_data(),p=De(e.url.pathname),w=[],d=o.ssr(),h=o.csr();if(d===!1&&!(a.prerendering&&m))return te&&l&&!e.request.headers.has("x-sveltekit-action")&&(l.type==="error"?console.warn("The form action returned an error, but +error.svelte wasn't rendered because SSR is off. To get the error page with CSR, enhance your form with `use:enhance`. See https://svelte.dev/docs/kit/form-actions#progressive-enhancement-use-enhance"):l.data&&console.warn("The form action returned a value, but it isn't available in `page.form`, because SSR is off. To handle the returned value in CSR, enhance your form with `use:enhance`. See https://svelte.dev/docs/kit/form-actions#progressive-enhancement-use-enhance")),await fe({branch:[],fetched:w,page_config:{ssr:!1,csr:h},status:u,error:null,event:e,event_state:t,options:n,manifest:s,state:a,resolve_opts:i,data_serializer:ue(e,t,n)});const g=[];let b=null;const R=ue(e,t,n),v=a.prerendering&&m?Lt(e,t,n):null,j=o.data.map(($,y)=>{if(b)throw b;return Promise.resolve().then(async()=>{try{if($===c&&l?.type==="error")throw l.error;const k=await Fe({event:e,event_state:t,state:a,node:$,parent:async()=>{const E={};for(let x=0;x<y;x+=1){const T=await j[x];T&&Object.assign(E,T.data)}return E}});return $&&R.add_node(y,k),v?.add_node(y,k),k}catch(k){throw b=k,b}})}),_=o.data.map(($,y)=>{if(b)throw b;return Promise.resolve().then(async()=>{try{return await Ht({event:e,event_state:t,fetched:w,node:$,parent:async()=>{const k={};for(let E=0;E<y;E+=1)Object.assign(k,await _[E]);return k},resolve_opts:i,server_data_promise:j[y],state:a,csr:h})}catch(k){throw b=k,b}})});for(const $ of j)$.catch(()=>{});for(const $ of _)$.catch(()=>{});for(let $=0;$<o.data.length;$+=1){const y=o.data[$];if(y)try{const k=await j[$],E=await _[$];g.push({node:y,server_data:k,data:E})}catch(k){const E=k;if(E instanceof M){if(a.prerendering&&m){const C=JSON.stringify({type:"redirect",location:E.location});a.prerendering.dependencies.set(p,{response:U(C),body:C})}return ve(E.status,E.location)}const x=oe(E),T=await W(e,t,n,E);for(;$--;)if(r.errors[$]){const C=r.errors[$],F=await s._.nodes[C]();let B=$;for(;!g[B];)B-=1;R.set_max_nodes(B+1);const G=qe(g.slice(0,B+1)),K=new Be(G.map(he=>he.node));return await fe({event:e,event_state:t,options:n,manifest:s,state:a,resolve_opts:i,page_config:{ssr:K.ssr(),csr:K.csr()},status:x,error:T,branch:G.concat({node:F,data:null,server_data:null}),fetched:w,data_serializer:R})}return ke(n,x,T.message)}else g.push(null)}if(a.prerendering&&v){let{data:$,chunks:y}=v.get_data();if(y)for await(const k of y)$+=k;a.prerendering.dependencies.set(p,{response:U($),body:$})}return await fe({event:e,event_state:t,options:n,manifest:s,state:a,resolve_opts:i,page_config:{csr:h,ssr:d},status:u,error:null,branch:d===!1?[]:qe(g),action_result:l,fetched:w,data_serializer:d===!1?ue(e,t,n):R})}catch(c){return await Kt({event:e,event_state:t,options:n,manifest:s,state:a,status:500,error:c,resolve_opts:i})}}function pn(e){let t=!1,r;return()=>t?r:(t=!0,r=e())}async function _n(e,t,r,n,s,a,o,i){if(!r.page)return new Response(void 0,{status:404});try{const c=[...r.page.layouts,r.page.leaf],u=o??c.map(()=>!0);let l=!1;const f=new URL(e.url);f.pathname=ze(f.pathname,i);const m={...e,url:f},p=c.map((v,j)=>pn(async()=>{try{if(l)return{type:"skip"};const _=v==null?v:await s._.nodes[v]();return Fe({event:m,event_state:t,state:a,node:_,parent:async()=>{const $={};for(let y=0;y<j;y+=1){const k=await p[y]();k&&Object.assign($,k.data)}return $}})}catch(_){throw l=!0,_}})),w=p.map(async(v,j)=>u[j]?v():{type:"skip"});let d=w.length;const h=await Promise.all(w.map((v,j)=>v.catch(async _=>{if(_ instanceof M)throw _;return d=Math.min(d,j+1),{type:"error",error:await W(e,t,n,_),status:_ instanceof ne||_ instanceof D?_.status:void 0}}))),g=Lt(e,t,n);for(let v=0;v<h.length;v++)g.add_node(v,h[v]);const{data:b,chunks:R}=g.get_data();return R?new Response(new ReadableStream({async start(v){v.enqueue(ae.encode(b));for await(const j of R)v.enqueue(ae.encode(j));v.close()},type:"bytes"}),{headers:{"content-type":"text/sveltekit-data","cache-control":"private, no-store"}}):Pe(b)}catch(c){const u=c;return u instanceof M?Ne(u):Pe(await W(e,t,n,u),500)}}function Pe(e,t=200){return U(typeof e=="string"?e:JSON.stringify(e),{status:t,headers:{"content-type":"application/json","cache-control":"private, no-store"}})}function Ne(e){return Pe({type:"redirect",location:e.location})}const mn=/[\x00-\x1F\x7F()<>@,;:"/[\]?={} \t]/,we={},gn=4129;function Se(e){if(e?.path===void 0)throw new Error("You must specify a `path` when setting, deleting or serializing cookies")}function yn(e,t,r){return`${e||""}${t}?${encodeURIComponent(r)}`}function wn(e,t){const r=e.headers.get("cookie")??"",n=ye(r,{decode:m=>m});let s;const a=new Map,o={httpOnly:!0,sameSite:"lax",secure:!(t.hostname==="localhost"&&t.protocol==="http:")},i={get(m,p){const w=Array.from(a.values()).filter(g=>g.name===m&&je(t.hostname,g.options.domain)&&$e(t.pathname,g.options.path)).sort((g,b)=>b.options.path.length-g.options.path.length)[0];if(w)return w.options.maxAge===0?void 0:w.value;const h=ye(r,{decode:p?.decode})[m];if(!h){const g=Array.from(we[m]??[]).filter(b=>$e(b,t.pathname)&&b!==t.pathname);g.length>0&&console.warn(`'${m}' cookie does not exist for ${t.pathname}, but was previously set at ${$n([...g])}. Did you mean to set its 'path' to '/' instead?`)}return h},getAll(m){const p=ye(r,{decode:m?.decode}),w=new Map;for(const d of a.values())if(je(t.hostname,d.options.domain)&&$e(t.pathname,d.options.path)){const h=w.get(d.name);(!h||d.options.path.length>h.options.path.length)&&w.set(d.name,d)}for(const d of w.values())p[d.name]=d.value;return Object.entries(p).map(([d,h])=>({name:d,value:h}))},set(m,p,w){const d=m.match(mn);d&&console.warn(`The cookie name "${m}" will be invalid in SvelteKit 3.0 as it contains ${d.join(" and ")}. See RFC 2616 for more details https://datatracker.ietf.org/doc/html/rfc2616#section-2.2`),Se(w),l(m,p,{...o,...w})},delete(m,p){Se(p),i.set(m,"",{...p,maxAge:0})},serialize(m,p,w){Se(w);let d=w.path;if(!w.domain||w.domain===t.hostname){if(!s)throw new Error("Cannot serialize cookies until after the route is determined");d=Ke(s,d)}return be(m,p,{...o,...w,path:d})}};function c(m,p){const w={...n};for(const d of a.values()){if(!je(m.hostname,d.options.domain)||!$e(m.pathname,d.options.path))continue;const h=d.options.encode||encodeURIComponent;w[d.name]=h(d.value)}if(p){const d=ye(p,{decode:h=>h});for(const h in d)w[h]=d[h]}return Object.entries(w).map(([d,h])=>`${d}=${h}`).join("; ")}const u=[];function l(m,p,w){if(!s){u.push(()=>l(m,p,w));return}let d=w.path;(!w.domain||w.domain===t.hostname)&&(d=Ke(s,d));const h=yn(w.domain,d,m),g={name:m,value:p,options:{...w,path:d}};a.set(h,g);{const b=be(m,p,g.options);if(ae.encode(b).byteLength>gn)throw new Error(`Cookie "${m}" is too large, and will be discarded by the browser`);we[m]??=new Set,p?we[m].add(d):we[m].delete(d)}}function f(m){s=ze(t.pathname,m),u.forEach(p=>p())}return{cookies:i,new_cookies:a,get_cookie_header:c,set_internal:l,set_trailing_slash:f}}function je(e,t){if(!t)return!0;const r=t[0]==="."?t.slice(1):t;return e===r?!0:e.endsWith("."+r)}function $e(e,t){if(!t)return!0;const r=t.endsWith("/")?t.slice(0,-1):t;return e===r?!0:e.startsWith(r+"/")}function st(e,t){for(const r of t){const{name:n,value:s,options:a}=r;if(e.append("set-cookie",be(n,s,a)),a.path.endsWith(".html")){const o=De(a.path);e.append("set-cookie",be(n,s,{...a,path:o}))}}}function $n(e){return e.length<=2?e.join(" and "):`${e.slice(0,-1).join(", ")} and ${e.at(-1)}`}function bn({event:e,options:t,manifest:r,state:n,get_cookie_header:s,set_internal:a}){const o=async(i,c)=>{const u=at(i,c,e.url);let l=(i instanceof Request?i.mode:c?.mode)??"cors",f=(i instanceof Request?i.credentials:c?.credentials)??"same-origin";return t.hooks.handleFetch({event:e,request:u,fetch:async(m,p)=>{const w=at(m,p,e.url),d=new URL(w.url);if(w.headers.has("origin")||w.headers.set("origin",e.url.origin),m!==u&&(l=(m instanceof Request?m.mode:p?.mode)??"cors",f=(m instanceof Request?m.credentials:p?.credentials)??"same-origin"),(w.method==="GET"||w.method==="HEAD")&&(l==="no-cors"&&d.origin!==e.url.origin||d.origin===e.url.origin)&&w.headers.delete("origin"),d.origin!==e.url.origin){if(`.${d.hostname}`.endsWith(`.${e.url.hostname}`)&&f!=="omit"){const y=s(d,w.headers.get("cookie"));y&&w.headers.set("cookie",y)}return fetch(w)}const h=X||z,g=decodeURIComponent(d.pathname),b=(g.startsWith(h)?g.slice(h.length):g).slice(1),R=`${b}/index.html`,v=r.assets.has(b)||b in r._.server_assets,j=r.assets.has(R)||R in r._.server_assets;if(v||j){const y=v?b:R;if(n.read){const k=v?r.mimeTypes[b.slice(b.lastIndexOf("."))]:"text/html";return new Response(n.read(y),{headers:k?{"content-type":k}:{}})}else if(Xe&&y in r._.server_assets){const k=r._.server_assets[y],E=r.mimeTypes[y.slice(y.lastIndexOf("."))];return new Response(Xe(y),{headers:{"Content-Length":""+k,"Content-Type":E}})}return await fetch(w)}if(jt(r,z+g))return await fetch(w);if(f!=="omit"){const y=s(d,w.headers.get("cookie"));y&&w.headers.set("cookie",y);const k=e.request.headers.get("authorization");k&&!w.headers.has("authorization")&&w.headers.set("authorization",k)}w.headers.has("accept")||w.headers.set("accept","*/*"),w.headers.has("accept-language")||w.headers.set("accept-language",e.request.headers.get("accept-language"));const _=await kn(w,t,r,n),$=_.headers.get("set-cookie");if($)for(const y of Qe.splitCookiesString($)){const{name:k,value:E,...x}=Qe.parseString(y,{decodeValues:!1}),T=x.path??(d.pathname.split("/").slice(0,-1).join("/")||"/");a(k,E,{path:T,encode:C=>C,...x})}return _}})};return(i,c)=>{const u=o(i,c);return u.catch(()=>{}),u}}function at(e,t,r){return e instanceof Request?e:new Request(typeof e=="string"?new URL(e,r):e,t)}async function kn(e,t,r,n){if(e.signal){if(e.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");let s=()=>{};const a=new Promise((i,c)=>{const u=()=>{c(new DOMException("The operation was aborted.","AbortError"))};e.signal.addEventListener("abort",u,{once:!0}),s=()=>e.signal.removeEventListener("abort",u)}),o=await Promise.race([Ue(e,t,r,{...n,depth:n.depth+1}),a]);return s(),o}else return await Ue(e,t,r,{...n,depth:n.depth+1})}let ot,Te,Ae;function vn(e){return ot??=`export const env=${JSON.stringify(Oe)}`,Te??=`W/${Date.now()}`,Ae??=new Headers({"content-type":"application/javascript; charset=utf-8",etag:Te}),e.headers.get("if-none-match")===Te?new Response(void 0,{status:304,headers:Ae}):new Response(ot,{headers:Ae})}const it=new Set(["max-age","public","private","no-cache","no-store","must-revalidate","proxy-revalidate","s-maxage","immutable","stale-while-revalidate","stale-if-error","no-transform","only-if-cached","max-stale","min-fresh"]),En=/^(application|audio|example|font|haptics|image|message|model|multipart|text|video|x-[a-z]+)\/[-+.\w]+$/i,xn={"cache-control":e=>{const t=`(While parsing "${e}".)`,r=e.split(",").map(a=>a.trim());if(r.some(a=>!a))throw new Error(`\`cache-control\` header contains empty directives. ${t}`);const s=r.map(a=>a.split("=")[0].toLowerCase()).find(a=>!it.has(a));if(s)throw new Error(`Invalid cache-control directive "${s}". Did you mean one of: ${[...it].join(", ")}? ${t}`)},"content-type":e=>{const t=e.split(";")[0].trim(),r=`(While parsing "${e}".)`;if(!En.test(t))throw new Error(`Invalid content-type value "${t}". ${r}`)}};function Rn(e){for(const[t,r]of Object.entries(e)){const n=xn[t.toLowerCase()];try{n?.(r)}catch(s){s instanceof Error&&console.warn(`[SvelteKit] ${s.message}`)}}}const ct=({html:e})=>e,lt=()=>!1,dt=({type:e})=>e==="js"||e==="css",Sn=new Set(["GET","HEAD","POST"]),jn=new Set(["GET","HEAD","OPTIONS"]);let ut=!1;const Ue=On(Tn);async function Tn(e,t,r,n){const s=new URL(e.url),a=Ur(s.pathname),o=Pr(s.pathname),i=dn(s);if(t.hash_routing&&s.pathname!==z+"/"&&s.pathname!=="/[fallback]")return U("Not found",{status:404});let c;a?s.pathname=zr(s.pathname):o?(s.pathname=Nr(s.pathname)+(s.searchParams.get(Ve)==="1"?"/":"")||"/",s.searchParams.delete(Ve),c=s.searchParams.get(Ge)?.split("").map(_=>_==="1"),s.searchParams.delete(Ge)):i&&(s.pathname=e.headers.get("x-sveltekit-pathname")??z,s.search=e.headers.get("x-sveltekit-search")??"");const u={},{cookies:l,new_cookies:f,get_cookie_header:m,set_internal:p,set_trailing_slash:w}=wn(e,s),d={prerendering:n.prerendering,transport:t.hooks.transport,handleValidationError:t.hooks.handleValidationError,tracing:{record_span:re},is_in_remote_function:!1},h={cookies:l,fetch:null,getClientAddress:n.getClientAddress||(()=>{throw new Error("@sveltejs/adapter-static does not specify getClientAddress. Please raise an issue")}),locals:{},params:{},platform:n.platform,request:e,route:{id:null},setHeaders:_=>{Rn(_);for(const $ in _){const y=$.toLowerCase(),k=_[$];if(y==="set-cookie")throw new Error("Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies");if(y in u)if(y==="server-timing")u[y]+=", "+k;else throw new Error(`"${$}" header is already set`);else u[y]=k,n.prerendering&&y==="cache-control"&&(n.prerendering.cache=k)}},url:s,isDataRequest:o,isSubRequest:n.depth>0,isRemoteRequest:!!i};h.fetch=bn({event:h,options:t,manifest:r,state:n,get_cookie_header:m,set_internal:p}),n.emulator?.platform&&(h.platform=await n.emulator.platform({config:{},prerender:!!n.prerendering?.fallback}));let g=s.pathname;if(!i){const _=n.prerendering?.inside_reroute;try{n.prerendering&&(n.prerendering.inside_reroute=!0),g=await t.hooks.reroute({url:new URL(s),fetch:h.fetch})??s.pathname}catch{return U("Internal Server Error",{status:500})}finally{n.prerendering&&(n.prerendering.inside_reroute=_)}}try{g=_r(g)}catch{return U("Malformed URI",{status:400})}if(g!==s.pathname&&!n.prerendering?.fallback&&jt(r,g)){const _=new URL(e.url);_.pathname=o?De(g):a?Ot(g):g;const $=await fetch(_,e),y=new Headers($.headers);return y.has("content-encoding")&&(y.delete("content-encoding"),y.delete("content-length")),new Response($.body,{headers:y,status:$.status,statusText:$.statusText})}let b=null;if(z&&!n.prerendering?.fallback){if(!g.startsWith(z))return U("Not found",{status:404});g=g.slice(z.length)||"/"}if(a)return rn(g,new URL(e.url),r);if(g===`/${se}/env.js`)return vn(e);if(!i&&g.startsWith(`/${se}`)){const _=new Headers;return _.set("cache-control","public, max-age=0, must-revalidate"),U("Not found",{status:404,headers:_})}if(!n.prerendering?.fallback){const _=await r._.matchers();for(const $ of r._.routes){const y=$.pattern.exec(g);if(!y)continue;const k=Vt(y,$.params,_);if(k){b=$,h.route={id:b.id},h.params=gt(k);break}}}let R={transformPageChunk:ct,filterSerializedResponseHeaders:lt,preload:dt},v="never";try{const _=b?.page?new Be(await An(b.page,r)):void 0;if(b&&!i){if(s.pathname===z||s.pathname===z+"/")v="always";else if(_)te&&_.validate(),v=_.trailing_slash();else if(b.endpoint){const y=await b.endpoint();v=y.trailingSlash??"never",te&&mr(y,b.endpoint_id)}if(!o){const y=ze(s.pathname,v);if(y!==s.pathname&&!n.prerendering?.fallback)return new Response(void 0,{status:308,headers:{"x-sveltekit-normalize":"1",location:(y.startsWith("//")?s.origin+y:y)+(s.search==="?"?"":s.search)}})}if(n.before_handle||n.emulator?.platform){let y={},k=!1;if(b.endpoint){const E=await b.endpoint();y=E.config??y,k=E.prerender??k}else _&&(y=_.get_config()??y,k=_.prerender());n.before_handle&&n.before_handle(h,y,k),n.emulator?.platform&&(h.platform=await n.emulator.platform({config:y,prerender:k}))}}w(v),n.prerendering&&!n.prerendering.fallback&&!n.prerendering.inside_reroute&&mt(s);const $=await re({name:"sveltekit.handle.root",attributes:{"http.route":h.route.id||"unknown","http.method":h.request.method,"http.url":h.url.href,"sveltekit.is_data_request":o,"sveltekit.is_sub_request":h.isSubRequest},fn:async y=>{const k={...h,tracing:{enabled:!1,root:y,current:y}};return await I({event:k,state:d},()=>t.hooks.handle({event:k,resolve:(E,x)=>re({name:"sveltekit.resolve",attributes:{"http.route":E.route.id||"unknown"},fn:T=>I(null,()=>j(ie(E,T),_,x).then(C=>{for(const F in u){const B=u[F];C.headers.set(F,B)}return st(C.headers,f.values()),n.prerendering&&E.route.id!==null&&C.headers.set("x-sveltekit-routeid",encodeURI(E.route.id)),T.setAttributes({"http.response.status_code":C.status,"http.response.body.size":C.headers.get("content-length")||"unknown"}),C}))})}))}});if($.status===200&&$.headers.has("etag")){let y=e.headers.get("if-none-match");y?.startsWith('W/"')&&(y=y.substring(2));const k=$.headers.get("etag");if(y===k){const E=new Headers({etag:k});for(const x of["cache-control","content-location","date","expires","vary","set-cookie"]){const T=$.headers.get(x);T&&E.set(x,T)}return new Response(void 0,{status:304,headers:E})}}if(o&&$.status>=300&&$.status<=308){const y=$.headers.get("location");if(y)return Ne(new M($.status,y))}return $}catch(_){if(_ instanceof M){const $=o||i?Ne(_):b?.page&&qt(h)?Ct(_):ve(_.status,_.location);return st($.headers,f.values()),$}return await et(h,d,t,_)}async function j(_,$,y){try{if(y&&(R={transformPageChunk:y.transformPageChunk||ct,filterSerializedResponseHeaders:y.filterSerializedResponseHeaders||lt,preload:y.preload||dt}),t.hash_routing||n.prerendering?.fallback)return await fe({event:_,event_state:d,options:t,manifest:r,state:n,page_config:{ssr:!1,csr:!0},status:200,error:null,branch:[],fetched:[],resolve_opts:R,data_serializer:ue(_,d,t)});if(i)return await an(_,d,t,r,i);if(b){const E=_.request.method;let x;if(o)x=await _n(_,d,b,t,r,n,c,v);else if(b.endpoint&&(!b.page||Cr(_)))x=await qr(_,d,await b.endpoint(),n);else if(b.page)if($)if(Sn.has(E))x=await hn(_,d,b.page,t,r,n,$,R);else{const T=new Set(jn);if((await r._.nodes[b.page.leaf]())?.server?.actions&&T.add("POST"),E==="OPTIONS")x=new Response(null,{status:204,headers:{allow:Array.from(T.values()).join(", ")}});else{const F=[...T].reduce((B,G)=>(B[G]=!0,B),{});x=Et(F,E)}}else throw new Error("page_nodes not found. This should never happen");else throw new Error("Route is neither page nor endpoint. This should never happen");if(e.method==="GET"&&b.page&&b.endpoint){const T=x.headers.get("vary")?.split(",")?.map(C=>C.trim().toLowerCase());T?.includes("accept")||T?.includes("*")||(x=new Response(x.body,{status:x.status,statusText:x.statusText,headers:new Headers(x.headers)}),x.headers.append("Vary","Accept"))}return x}if(n.error&&_.isSubRequest){const E=new Headers(e.headers);return E.set("x-sveltekit-error","true"),await fetch(e,{headers:E})}if(n.error)return U("Internal Server Error",{status:500});if(n.depth===0)return te&&_.url.pathname==="/.well-known/appspecific/com.chrome.devtools.json"?(ut||(console.log(`
Google Chrome is requesting ${_.url.pathname} to automatically configure devtools project settings. To learn why, and how to prevent this message, see https://svelte.dev/docs/cli/devtools-json
`),ut=!0),new Response(void 0,{status:404})):await Kt({event:_,event_state:d,options:t,manifest:r,state:n,status:404,error:new D(404,"Not Found",`Not found: ${_.url.pathname}`),resolve_opts:R});if(n.prerendering)return U("not found",{status:404});const k=await fetch(e);return new Response(k.body,k)}catch(k){return await et(_,d,t,k)}finally{_.cookies.set=()=>{throw new Error("Cannot use `cookies.set(...)` after the response has been generated")},_.setHeaders=()=>{throw new Error("Cannot use `setHeaders(...)` after the response has been generated")}}}}function An(e,t){return Promise.all([...e.layouts.map(r=>r==null?r:t._.nodes[r]()),t._.nodes[e.leaf]()])}function On(e){return async(t,...r)=>e(t,...r)}function ft(e,t,r){return Object.fromEntries(Object.entries(e).filter(([n])=>n.startsWith(t)&&(r===""||!n.startsWith(r))))}let qn,ht=null;class Mn{#e;#t;constructor(t){if(this.#e=sr,this.#t=t,br){const r=this.respond.bind(this);this.respond=async(...n)=>{const{promise:s,resolve:a}=yt(),o=ht;return ht=s,await o,r(...n).finally(a)}}}async init({env:t,read:r}){const{env_public_prefix:n,env_private_prefix:s}=this.#e;ar(ft(t,s,n)),or(ft(t,n,s)),r&&cr(o=>{const i=r(o);return i instanceof ReadableStream?i:new ReadableStream({async start(c){try{const u=await Promise.resolve(i);if(!u){c.close();return}const l=u.getReader();for(;;){const{done:f,value:m}=await l.read();if(f)break;c.enqueue(m)}c.close()}catch(u){c.error(u)}}})}),await(qn??=(async()=>{try{const a=await ir();this.#e.hooks={handle:a.handle||(({event:o,resolve:i})=>i(o)),handleError:a.handleError||(({status:o,error:i,event:c})=>{const u=Ar(o,i,c);console.error(u)}),handleFetch:a.handleFetch||(({request:o,fetch:i})=>i(o)),handleValidationError:a.handleValidationError||(({issues:o})=>(console.error("Remote function schema validation failed:",o),{message:"Bad Request"})),reroute:a.reroute||(()=>{}),transport:a.transport||{}},a.transport&&Object.fromEntries(Object.entries(a.transport).map(([o,i])=>[o,i.decode])),a.init&&await a.init()}catch(a){this.#e.hooks={handle:()=>{throw a},handleError:({error:o})=>console.error(o),handleFetch:({request:o,fetch:i})=>i(o),handleValidationError:()=>({message:"Bad Request"}),reroute:()=>{},transport:{}}}})())}async respond(t,r){return Ue(t,this.#e,this.#t,{...r,error:!1,depth:0})}}export{Mn as Server};
