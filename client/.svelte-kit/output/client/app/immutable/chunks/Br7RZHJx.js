var Vt=Object.defineProperty;var Ft=(s,e,t)=>e in s?Vt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Q=(s,e,t)=>Ft(s,typeof e!="symbol"?e+"":e,t);import{s as $e,$ as be,b as w,d as E,e as S,f as J,g as T,j as C,t as K,k as R,T as Qe,h as me,v as lt,c as at,o as ft,a0 as dt,r as Lt,n as Mt,w as ht}from"./DGcXZGHv.js";import{S as Te,i as Re,d as M,c as ne,v as Ie,a as p,b as H,t as P,e as I,s as he,g as ue,f as le,h as G,m as W,j as L,k as v,q as Ee,l as y,n as Z,o as ye,r as mt}from"./D4_HMhaq.js";import{g as Nt}from"./D0QH3NT1.js";import{d as jt,w as Je}from"./DU5LzBJr.js";import{H as At,s as vt,a as _t,u as gt}from"./DZPO9J1Y.js";import{A as pt,I as qe,c as Ht,G as Gt,d as bt,W as Wt,e as zt,f as Qt,M as Jt}from"./C8YzKFhu.js";function we(){try{const s=typeof window<"u"&&"__TAURI__"in window&&window.__TAURI__!==null;return console.log("[DEBUG] tauri.ts: isTauri() =",s),console.log("[DEBUG] tauri.ts: typeof window =",typeof window),console.log("[DEBUG] tauri.ts: __TAURI__ in window =",typeof window<"u"&&"__TAURI__"in window),s}catch{return console.log("[DEBUG] tauri.ts: isTauri() caught exception, returning false"),!1}}async function yt(s,e){if(console.log(`[DEBUG] tauri.ts: safeInvoke('${s}') called`),!we())return console.warn(`[Tauri] Not in Tauri environment, skipping invoke: ${s}`),null;try{return console.log(`[DEBUG] tauri.ts: Invoking command '${s}' with args:`,e),await window.__TAURI__.invoke(s,e)}catch(t){return console.error(`[Tauri] Failed to invoke ${s}:`,t),null}}function kt(s,e){if(console.log(`[DEBUG] tauri.ts: safeListen('${s}') called`),!we())return console.warn(`[Tauri] Not in Tauri environment, skipping event listener: ${s}`),()=>{};try{console.log(`[DEBUG] tauri.ts: Listening to event '${s}'`);const t=window.__TAURI__.event.listen(s,e);return()=>{t.then(o=>o()).catch(o=>console.error(`[Tauri] Failed to unlisten from ${s}:`,o))}}catch(t){return console.error(`[Tauri] Failed to listen to ${s}:`,t),()=>{}}}class Kt{constructor(e={}){Q(this,"ws",null);Q(this,"url");Q(this,"reconnectInterval");Q(this,"maxReconnectAttempts");Q(this,"reconnectAttempts",0);Q(this,"reconnectTimer",null);Q(this,"isManualClose",!1);Q(this,"lastErrorLogged",0);Q(this,"onOpenCallback",null);Q(this,"onCloseCallback",null);Q(this,"onErrorCallback",null);Q(this,"onMessageCallback",null);this.url=e.url||"ws://localhost:8081/ws",this.reconnectInterval=e.reconnectInterval||5e3,this.maxReconnectAttempts=e.maxReconnectAttempts||10}connect(){this.ws&&this.ws.readyState===WebSocket.OPEN||(this.isManualClose=!1,this.ws=new WebSocket(this.url),this.ws.onopen=()=>{console.log("[Socket] Connected to",this.url),this.reconnectAttempts=0,this.onOpenCallback&&this.onOpenCallback()},this.ws.onclose=e=>{console.log("[Socket] Disconnected",e.code,e.reason),this.onCloseCallback&&this.onCloseCallback(),!this.isManualClose&&this.reconnectAttempts<this.maxReconnectAttempts&&this.scheduleReconnect()},this.ws.onerror=e=>{const t=Date.now();t-this.lastErrorLogged>5e3&&(console.warn("[Socket] Connection error (server may be offline)"),this.lastErrorLogged=t),this.onErrorCallback&&this.onErrorCallback(e)},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.onMessageCallback&&this.onMessageCallback(t)}catch(t){console.error("[Socket] Failed to parse message:",t)}})}disconnect(){this.isManualClose=!0,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(),this.ws=null)}sendText(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN){console.warn("[Socket] Cannot send message: not connected");return}this.ws.send(e)}sendBinary(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN){console.warn("[Socket] Cannot send binary data: not connected");return}this.ws.send(e)}sendAudio(e){e.arrayBuffer().then(t=>{this.sendBinary(t)})}scheduleReconnect(){this.reconnectTimer||(this.reconnectAttempts++,console.log(`[Socket] Reconnecting in ${this.reconnectInterval}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.reconnectTimer=null,this.connect()},this.reconnectInterval))}isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}getReadyState(){return this.ws?.readyState??WebSocket.CLOSED}onOpen(e){this.onOpenCallback=e}onClose(e){this.onCloseCallback=e}onError(e){this.onErrorCallback=e}onMessage(e){this.onMessageCallback=e}clearCallbacks(){this.onOpenCallback=null,this.onCloseCallback=null,this.onErrorCallback=null,this.onMessageCallback=null}}function Xt(s){return new Kt(s)}const se=Xt({url:"ws://localhost:8081/ws",reconnectInterval:5e3,maxReconnectAttempts:10}),pe=Je(!1),ke=Je(""),Ke=Je(null);jt(pe,s=>s?"connected":"disconnected");se.onOpen(()=>{pe.set(!0),Ke.set(null)});se.onClose(()=>{pe.set(!1)});se.onError(s=>{Ke.set("Connection error")});se.onMessage(s=>{s.type==="transcription"?ke.set(s.text):s.type==="error"&&Ke.set(s.message)});function wt(){se.connect()}function Yt(){se.disconnect()}function Et(s){se.sendAudio(s)}function Ct(){se.clearCallbacks(),se.disconnect()}const ge="C:/Users/Евгений/Documents/AlfaVoice/client/src/lib/components/Banner.svelte";function Le(s){let e,t,o,h,i,c,m,r,f,n,a,_,u,l,g,k;var D=pt;function U(q,B){return{props:{size:18},$$inline:!0}}D&&(u=ne(D,U()));const V={c:function(){e=C("div"),t=C("div"),o=C("h2"),h=K(s[0]),i=R(),c=C("p"),m=K(s[1]),r=R(),f=C("button"),n=C("span"),a=K(s[2]),_=R(),u&&G(u.$$.fragment),this.h()},l:function(B){e=E(B,"DIV",{class:!0});var d=S(e);t=E(d,"DIV",{class:!0});var b=S(t);o=E(b,"H2",{class:!0});var $=S(o);h=J($,s[0]),$.forEach(p),i=T(b),c=E(b,"P",{class:!0});var O=S(c);m=J(O,s[1]),O.forEach(p),b.forEach(p),r=T(d),f=E(d,"BUTTON",{class:!0});var j=S(f);n=E(j,"SPAN",{});var ee=S(n);a=J(ee,s[2]),ee.forEach(p),_=T(j),u&&Z(u.$$.fragment,j),j.forEach(p),d.forEach(p),this.h()},h:function(){y(o,"class","banner-title svelte-198123s"),w(o,ge,13,2,841),y(c,"class","banner-description svelte-198123s"),w(c,ge,14,2,881),y(t,"class","banner-content svelte-198123s"),w(t,ge,12,1,810),w(n,ge,17,2,1006),y(f,"class","banner-button svelte-198123s"),w(f,ge,16,1,938),y(e,"class","banner svelte-198123s"),w(e,ge,11,0,788)},m:function(B,d){L(B,e,d),v(e,t),v(t,o),v(o,h),v(t,i),v(t,c),v(c,m),v(e,r),v(e,f),v(f,n),v(n,a),v(f,_),u&&W(u,f,null),l=!0,g||(k=Ee(f,"click",s[4],!1),g=!0)},p:function(B,[d]){if((!l||d&1)&&he(h,B[0]),(!l||d&2)&&he(m,B[1]),(!l||d&4)&&he(a,B[2]),D!==(D=pt)){if(u){ue();const b=u;P(b.$$.fragment,1,0,()=>{H(b,1)}),le()}D?(u=ne(D,U()),G(u.$$.fragment),I(u.$$.fragment,1),W(u,f,null)):u=null}},i:function(B){l||(u&&I(u.$$.fragment,B),l=!0)},o:function(B){u&&P(u.$$.fragment,B),l=!1},d:function(B){B&&p(e),u&&H(u),g=!1,k()}};return M("SvelteRegisterBlock",{block:V,id:Le.name,type:"component",source:"",ctx:s}),V}function Zt(s,e,t){let{$$slots:o={},$$scope:h}=e;Ie("Banner",o,[]);const i=be();let{title:c="Настройте звучание AlfaVoice"}=e,{description:m="Адаптируйте голосовой ввод под ваш стиль письма и профессиональный словарь."}=e,{buttonText:r="Начать"}=e;const f=["title","description","buttonText"];Object.keys(e).forEach(a=>{!~f.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<Banner> was created with unknown prop '${a}'`)});const n=()=>i("click");return s.$$set=a=>{"title"in a&&t(0,c=a.title),"description"in a&&t(1,m=a.description),"buttonText"in a&&t(2,r=a.buttonText)},s.$capture_state=()=>({createEventDispatcher:be,Icons:qe,dispatch:i,title:c,description:m,buttonText:r}),s.$inject_state=a=>{"title"in a&&t(0,c=a.title),"description"in a&&t(1,m=a.description),"buttonText"in a&&t(2,r=a.buttonText)},e&&"$$inject"in e&&s.$inject_state(e.$$inject),[c,m,r,i,n]}class $t extends Te{constructor(e){super(e),Re(this,e,Zt,Le,$e,{title:0,description:1,buttonText:2}),M("SvelteRegisterComponent",{component:this,tagName:"Banner",options:e,id:Le.name})}get title(){throw new Error("<Banner>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(e){throw new Error("<Banner>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get description(){throw new Error("<Banner>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set description(e){throw new Error("<Banner>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get buttonText(){throw new Error("<Banner>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set buttonText(e){throw new Error("<Banner>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const ce="C:/Users/Евгений/Documents/AlfaVoice/client/src/lib/components/QuickAccess.svelte";function Bt(s,e,t){const o=s.slice();return o[4]=e[t],o}function Me(s){let e,t,o,h,i,c,m=s[4].title+"",r,f,n,a=s[4].description+"",_,u,l,g,k;var D=s[4].icon;function U(B,d){return{props:{size:24},$$inline:!0}}D&&(o=ne(D,U()));function V(){return s[2](s[4])}const q={c:function(){e=C("button"),t=C("div"),o&&G(o.$$.fragment),h=R(),i=C("div"),c=C("h4"),r=K(m),f=R(),n=C("p"),_=K(a),u=R(),this.h()},l:function(d){e=E(d,"BUTTON",{class:!0});var b=S(e);t=E(b,"DIV",{class:!0});var $=S(t);o&&Z(o.$$.fragment,$),$.forEach(p),h=T(b),i=E(b,"DIV",{class:!0});var O=S(i);c=E(O,"H4",{class:!0});var j=S(c);r=J(j,m),j.forEach(p),f=T(O),n=E(O,"P",{class:!0});var ee=S(n);_=J(ee,a),ee.forEach(p),O.forEach(p),u=T(b),b.forEach(p),this.h()},h:function(){y(t,"class","card-icon svelte-1bcq7he"),w(t,ce,38,4,955),y(c,"class","card-title svelte-1bcq7he"),w(c,ce,42,5,1079),y(n,"class","card-description svelte-1bcq7he"),w(n,ce,43,5,1125),y(i,"class","card-content svelte-1bcq7he"),w(i,ce,41,4,1047),y(e,"class","card svelte-1bcq7he"),w(e,ce,37,3,891)},m:function(d,b){L(d,e,b),v(e,t),o&&W(o,t,null),v(e,h),v(e,i),v(i,c),v(c,r),v(i,f),v(i,n),v(n,_),v(e,u),l=!0,g||(k=Ee(e,"click",V,!1),g=!0)},p:function(d,b){if(s=d,D!==(D=s[4].icon)){if(o){ue();const $=o;P($.$$.fragment,1,0,()=>{H($,1)}),le()}D?(o=ne(D,U()),G(o.$$.fragment),I(o.$$.fragment,1),W(o,t,null)):o=null}},i:function(d){l||(o&&I(o.$$.fragment,d),l=!0)},o:function(d){o&&P(o.$$.fragment,d),l=!1},d:function(d){d&&p(e),o&&H(o),g=!1,k()}};return M("SvelteRegisterBlock",{block:q,id:Me.name,type:"each",source:"(26:2) {#each cards as card}",ctx:s}),q}function Ne(s){let e,t,o="Вернуться в поток",h,i,c,m=ye(s[0]),r=[];for(let a=0;a<m.length;a+=1)r[a]=Me(Bt(s,m,a));const f=a=>P(r[a],1,1,()=>{r[a]=null}),n={c:function(){e=C("section"),t=C("h3"),t.textContent=o,h=R(),i=C("div");for(let _=0;_<r.length;_+=1)r[_].c();this.h()},l:function(_){e=E(_,"SECTION",{class:!0});var u=S(e);t=E(u,"H3",{class:!0,"data-svelte-h":!0}),me(t)!=="svelte-wibglv"&&(t.textContent=o),h=T(u),i=E(u,"DIV",{class:!0});var l=S(i);for(let g=0;g<r.length;g+=1)r[g].l(l);l.forEach(p),u.forEach(p),this.h()},h:function(){y(t,"class","section-title svelte-1bcq7he"),w(t,ce,34,1,789),y(i,"class","cards-grid svelte-1bcq7he"),w(i,ce,35,1,839),y(e,"class","quick-access svelte-1bcq7he"),w(e,ce,33,0,757)},m:function(_,u){L(_,e,u),v(e,t),v(e,h),v(e,i);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,null);c=!0},p:function(_,[u]){if(u&3){m=ye(_[0]);let l;for(l=0;l<m.length;l+=1){const g=Bt(_,m,l);r[l]?(r[l].p(g,u),I(r[l],1)):(r[l]=Me(g),r[l].c(),I(r[l],1),r[l].m(i,null))}for(ue(),l=m.length;l<r.length;l+=1)f(l);le()}},i:function(_){if(!c){for(let u=0;u<m.length;u+=1)I(r[u]);c=!0}},o:function(_){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)P(r[u]);c=!1},d:function(_){_&&p(e),Qe(r,_)}};return M("SvelteRegisterBlock",{block:n,id:Ne.name,type:"component",source:"",ctx:s}),n}function en(s,e,t){let{$$slots:o={},$$scope:h}=e;Ie("QuickAccess",o,[]);const i=be(),c=[{id:"code",title:"Code",description:"Голосовой ввод для программирования",icon:Ht},{id:"chrome",title:"Chrome",description:"Быстрые заметки в браузере",icon:Gt}];function m(n){i("select",{cardId:n})}const r=[];Object.keys(e).forEach(n=>{!~r.indexOf(n)&&n.slice(0,2)!=="$$"&&n!=="slot"&&console.warn(`<QuickAccess> was created with unknown prop '${n}'`)});const f=n=>m(n.id);return s.$capture_state=()=>({createEventDispatcher:be,Icons:qe,dispatch:i,cards:c,onCardClick:m}),[c,m,f]}class Tt extends Te{constructor(e){super(e),Re(this,e,en,Ne,$e,{}),M("SvelteRegisterComponent",{component:this,tagName:"QuickAccess",options:e,id:Ne.name})}}const te="C:/Users/Евгений/Documents/AlfaVoice/client/src/lib/components/HistoryList.svelte";function Dt(s,e,t){const o=s.slice();return o[4]=e[t],o}function St(s,e,t){const o=s.slice();return o[7]=e[t],o}function je(s){let e,t,o,h,i,c=s[7].time+"",m,r,f,n=s[7].text+"",a,_,u,l,g;var k=bt;function D(q,B){return{props:{size:16,class:"entry-icon"},$$inline:!0}}k&&(t=ne(k,D()));function U(){return s[2](s[7])}const V={c:function(){e=C("button"),t&&G(t.$$.fragment),o=R(),h=C("div"),i=C("span"),m=K(c),r=R(),f=C("span"),a=K(n),_=R(),this.h()},l:function(B){e=E(B,"BUTTON",{class:!0});var d=S(e);t&&Z(t.$$.fragment,d),o=T(d),h=E(d,"DIV",{class:!0});var b=S(h);i=E(b,"SPAN",{class:!0});var $=S(i);m=J($,c),$.forEach(p),r=T(b),f=E(b,"SPAN",{class:!0});var O=S(f);a=J(O,n),O.forEach(p),b.forEach(p),_=T(d),d.forEach(p),this.h()},h:function(){y(i,"class","entry-time svelte-1kxaayy"),w(i,te,52,8,2248),y(f,"class","entry-text svelte-1kxaayy"),w(f,te,53,8,2301),y(h,"class","entry-content svelte-1kxaayy"),w(h,te,51,7,2212),y(e,"class","entry-item svelte-1kxaayy"),w(e,te,49,6,2061)},m:function(B,d){L(B,e,d),t&&W(t,e,null),v(e,o),v(e,h),v(h,i),v(i,m),v(h,r),v(h,f),v(f,a),v(e,_),u=!0,l||(g=Ee(e,"click",U,!1),l=!0)},p:function(B,d){if(s=B,k!==(k=bt)){if(t){ue();const b=t;P(b.$$.fragment,1,0,()=>{H(b,1)}),le()}k?(t=ne(k,D()),G(t.$$.fragment),I(t.$$.fragment,1),W(t,e,o)):t=null}(!u||d&1)&&c!==(c=s[7].time+"")&&he(m,c),(!u||d&1)&&n!==(n=s[7].text+"")&&he(a,n)},i:function(B){u||(t&&I(t.$$.fragment,B),u=!0)},o:function(B){t&&P(t.$$.fragment,B),u=!1},d:function(B){B&&p(e),t&&H(t),l=!1,g()}};return M("SvelteRegisterBlock",{block:V,id:je.name,type:"each",source:"(33:5) {#each group.entries as entry}",ctx:s}),V}function He(s){let e,t,o=s[4].date+"",h,i,c,m,r,f=ye(s[4].entries),n=[];for(let u=0;u<f.length;u+=1)n[u]=je(St(s,f,u));const a=u=>P(n[u],1,1,()=>{n[u]=null}),_={c:function(){e=C("div"),t=C("h4"),h=K(o),i=R(),c=C("div");for(let l=0;l<n.length;l+=1)n[l].c();m=R(),this.h()},l:function(l){e=E(l,"DIV",{class:!0});var g=S(e);t=E(g,"H4",{class:!0});var k=S(t);h=J(k,o),k.forEach(p),i=T(g),c=E(g,"DIV",{class:!0});var D=S(c);for(let U=0;U<n.length;U+=1)n[U].l(D);D.forEach(p),m=T(g),g.forEach(p),this.h()},h:function(){y(t,"class","group-date svelte-1kxaayy"),w(t,te,46,4,1947),y(c,"class","entries-list svelte-1kxaayy"),w(c,te,47,4,1992),y(e,"class","history-group svelte-1kxaayy"),w(e,te,45,3,1915)},m:function(l,g){L(l,e,g),v(e,t),v(t,h),v(e,i),v(e,c);for(let k=0;k<n.length;k+=1)n[k]&&n[k].m(c,null);v(e,m),r=!0},p:function(l,g){if((!r||g&1)&&o!==(o=l[4].date+"")&&he(h,o),g&3){f=ye(l[4].entries);let k;for(k=0;k<f.length;k+=1){const D=St(l,f,k);n[k]?(n[k].p(D,g),I(n[k],1)):(n[k]=je(D),n[k].c(),I(n[k],1),n[k].m(c,null))}for(ue(),k=f.length;k<n.length;k+=1)a(k);le()}},i:function(l){if(!r){for(let g=0;g<f.length;g+=1)I(n[g]);r=!0}},o:function(l){n=n.filter(Boolean);for(let g=0;g<n.length;g+=1)P(n[g]);r=!1},d:function(l){l&&p(e),Qe(n,l)}};return M("SvelteRegisterBlock",{block:_,id:He.name,type:"each",source:"(29:2) {#each history as group}",ctx:s}),_}function Ge(s){let e,t,o="История",h,i,c,m=ye(s[0]),r=[];for(let a=0;a<m.length;a+=1)r[a]=He(Dt(s,m,a));const f=a=>P(r[a],1,1,()=>{r[a]=null}),n={c:function(){e=C("section"),t=C("h3"),t.textContent=o,h=R(),i=C("div");for(let _=0;_<r.length;_+=1)r[_].c();this.h()},l:function(_){e=E(_,"SECTION",{class:!0});var u=S(e);t=E(u,"H3",{class:!0,"data-svelte-h":!0}),me(t)!=="svelte-ukje9l"&&(t.textContent=o),h=T(u),i=E(u,"DIV",{class:!0});var l=S(i);for(let g=0;g<r.length;g+=1)r[g].l(l);l.forEach(p),u.forEach(p),this.h()},h:function(){y(t,"class","section-title svelte-1kxaayy"),w(t,te,42,1,1815),y(i,"class","history-content svelte-1kxaayy"),w(i,te,43,1,1855),y(e,"class","history-list svelte-1kxaayy"),w(e,te,41,0,1783)},m:function(_,u){L(_,e,u),v(e,t),v(e,h),v(e,i);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,null);c=!0},p:function(_,[u]){if(u&3){m=ye(_[0]);let l;for(l=0;l<m.length;l+=1){const g=Dt(_,m,l);r[l]?(r[l].p(g,u),I(r[l],1)):(r[l]=He(g),r[l].c(),I(r[l],1),r[l].m(i,null))}for(ue(),l=m.length;l<r.length;l+=1)f(l);le()}},i:function(_){if(!c){for(let u=0;u<m.length;u+=1)I(r[u]);c=!0}},o:function(_){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)P(r[u]);c=!1},d:function(_){_&&p(e),Qe(r,_)}};return M("SvelteRegisterBlock",{block:n,id:Ge.name,type:"component",source:"",ctx:s}),n}function tn(s,e,t){let{$$slots:o={},$$scope:h}=e;Ie("HistoryList",o,[]);const i=be();let{history:c=[{date:"Сегодня",entries:[{id:"1",time:"14:30",text:"Создайте новый компонент для боковой панели с навигацией"},{id:"2",time:"12:15",text:"Обновите конфигурацию TailwindCSS для поддержки темной темы"},{id:"3",time:"10:45",text:"Добавьте иконки из библиотеки lucide-svelte"}]},{date:"Вчера",entries:[{id:"4",time:"16:20",text:"Настройте WebSocket соединение с сервером"},{id:"5",time:"14:05",text:"Реализуйте логику записи аудио с микрофона"}]}]}=e;function m(n){i("select",{entryId:n})}const r=["history"];Object.keys(e).forEach(n=>{!~r.indexOf(n)&&n.slice(0,2)!=="$$"&&n!=="slot"&&console.warn(`<HistoryList> was created with unknown prop '${n}'`)});const f=n=>m(n.id);return s.$$set=n=>{"history"in n&&t(0,c=n.history)},s.$capture_state=()=>({createEventDispatcher:be,Icons:qe,dispatch:i,history:c,onEntryClick:m}),s.$inject_state=n=>{"history"in n&&t(0,c=n.history)},e&&"$$inject"in e&&s.$inject_state(e.$$inject),[c,m,f]}class Rt extends Te{constructor(e){super(e),Re(this,e,tn,Ge,$e,{history:0}),M("SvelteRegisterComponent",{component:this,tagName:"HistoryList",options:e,id:Ge.name})}get history(){throw new Error("<HistoryList>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set history(e){throw new Error("<HistoryList>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const{console:nn}=Nt,F="C:/Users/Евгений/Documents/AlfaVoice/client/src/routes/+page.svelte";function It(s){let e,t,o,h="Сервер отключен",i;var c=zt;function m(f,n){return{props:{size:16,class:"status-icon disconnected"},$$inline:!0}}c&&(e=ne(c,m()));const r={c:function(){e&&G(e.$$.fragment),t=R(),o=C("span"),o.textContent=h,this.h()},l:function(n){e&&Z(e.$$.fragment,n),t=T(n),o=E(n,"SPAN",{class:!0,"data-svelte-h":!0}),me(o)!=="svelte-wvxfto"&&(o.textContent=h),this.h()},h:function(){y(o,"class","status-text svelte-2q0u1c"),w(o,F,167,4,4147)},m:function(n,a){e&&W(e,n,a),L(n,t,a),L(n,o,a),i=!0},i:function(n){i||(e&&I(e.$$.fragment,n),i=!0)},o:function(n){e&&P(e.$$.fragment,n),i=!1},d:function(n){n&&(p(t),p(o)),e&&H(e,n)}};return M("SvelteRegisterBlock",{block:r,id:It.name,type:"else",source:"(125:3) {:else}",ctx:s}),r}function qt(s){let e,t,o,h="Сервер подключен",i;var c=Wt;function m(f,n){return{props:{size:16,class:"status-icon connected"},$$inline:!0}}c&&(e=ne(c,m()));const r={c:function(){e&&G(e.$$.fragment),t=R(),o=C("span"),o.textContent=h,this.h()},l:function(n){e&&Z(e.$$.fragment,n),t=T(n),o=E(n,"SPAN",{class:!0,"data-svelte-h":!0}),me(o)!=="svelte-166aob3"&&(o.textContent=h),this.h()},h:function(){y(o,"class","status-text svelte-2q0u1c"),w(o,F,164,4,3993)},m:function(n,a){e&&W(e,n,a),L(n,t,a),L(n,o,a),i=!0},i:function(n){i||(e&&I(e.$$.fragment,n),i=!0)},o:function(n){e&&P(e.$$.fragment,n),i=!1},d:function(n){n&&(p(t),p(o)),e&&H(e,n)}};return M("SvelteRegisterBlock",{block:r,id:qt.name,type:"if",source:"(122:3) {#if $isConnected}",ctx:s}),r}function Ut(s){let e,t,o,h="Записать",i;var c=Jt;function m(f,n){return{props:{size:18},$$inline:!0}}c&&(e=ne(c,m()));const r={c:function(){e&&G(e.$$.fragment),t=R(),o=C("span"),o.textContent=h,this.h()},l:function(n){e&&Z(e.$$.fragment,n),t=T(n),o=E(n,"SPAN",{"data-svelte-h":!0}),me(o)!=="svelte-1igdl8d"&&(o.textContent=h),this.h()},h:function(){w(o,F,197,6,4920)},m:function(n,a){e&&W(e,n,a),L(n,t,a),L(n,o,a),i=!0},i:function(n){i||(e&&I(e.$$.fragment,n),i=!0)},o:function(n){e&&P(e.$$.fragment,n),i=!1},d:function(n){n&&(p(t),p(o)),e&&H(e,n)}};return M("SvelteRegisterBlock",{block:r,id:Ut.name,type:"else",source:"(155:5) {:else}",ctx:s}),r}function Ot(s){let e,t,o,h="Остановить",i;var c=Qt;function m(f,n){return{props:{size:18},$$inline:!0}}c&&(e=ne(c,m()));const r={c:function(){e&&G(e.$$.fragment),t=R(),o=C("span"),o.textContent=h,this.h()},l:function(n){e&&Z(e.$$.fragment,n),t=T(n),o=E(n,"SPAN",{"data-svelte-h":!0}),me(o)!=="svelte-1h67wdq"&&(o.textContent=h),this.h()},h:function(){w(o,F,194,6,4823)},m:function(n,a){e&&W(e,n,a),L(n,t,a),L(n,o,a),i=!0},i:function(n){i||(e&&I(e.$$.fragment,n),i=!0)},o:function(n){e&&P(e.$$.fragment,n),i=!1},d:function(n){n&&(p(t),p(o)),e&&H(e,n)}};return M("SvelteRegisterBlock",{block:r,id:Ot.name,type:"if",source:"(152:5) {#if isRecording}",ctx:s}),r}function Pt(s){let e,t,o;const h={c:function(){e=C("p"),t=K("Нажмите кнопку записи или используйте горячую клавишу "),o=K(s[4]),this.h()},l:function(c){e=E(c,"P",{class:!0});var m=S(e);t=J(m,"Нажмите кнопку записи или используйте горячую клавишу "),o=J(m,s[4]),m.forEach(p),this.h()},h:function(){y(e,"class","placeholder svelte-2q0u1c"),w(e,F,214,4,5257)},m:function(c,m){L(c,e,m),v(e,t),v(e,o)},p:Mt,d:function(c){c&&p(e)}};return M("SvelteRegisterBlock",{block:h,id:Pt.name,type:"else",source:"(173:3) {:else}",ctx:s}),h}function xt(s){let e,t;const o={c:function(){e=C("p"),t=K(s[0]),this.h()},l:function(i){e=E(i,"P",{class:!0});var c=S(e);t=J(c,s[0]),c.forEach(p),this.h()},h:function(){y(e,"class","svelte-2q0u1c"),w(e,F,212,4,5218)},m:function(i,c){L(i,e,c),v(e,t)},p:function(i,c){c&1&&he(t,i[0])},d:function(i){i&&p(e)}};return M("SvelteRegisterBlock",{block:o,id:xt.name,type:"if",source:"(171:3) {#if $transcription}",ctx:s}),o}function We(s){let e,t;const o={c:function(){e=C("div"),t=C("div"),this.h()},l:function(i){e=E(i,"DIV",{class:!0});var c=S(e);t=E(c,"DIV",{class:!0,style:!0}),S(t).forEach(p),c.forEach(p),this.h()},h:function(){y(t,"class","audio-level-bar svelte-2q0u1c"),ht(t,"width",s[2]*100+"%"),w(t,F,220,4,5452),y(e,"class","audio-level svelte-2q0u1c"),w(e,F,219,3,5422)},m:function(i,c){L(i,e,c),v(e,t)},p:function(i,c){c&4&&ht(t,"width",i[2]*100+"%")},d:function(i){i&&p(e)}};return M("SvelteRegisterBlock",{block:o,id:We.name,type:"if",source:"(178:2) {#if isRecording}",ctx:s}),o}function ze(s){let e,t,o,h,i,c,m,r,f,n,a,_,u,l,g,k,D,U,V,q="Транскрипция",B,d,b,$,O,j,ee,Ce,Ue,X,Oe,Be,Pe,oe,xe,Ve,ae,ie,Fe,Xe;t=new At({$$inline:!0});const Ye=[qt,It],fe=[];function Ze(z,A){return z[3]?0:1}c=Ze(s),m=fe[c]=Ye[c](s),u=new $t({$$inline:!0}),g=new Tt({$$inline:!0});const et=[Ot,Ut],de=[];function tt(z,A){return z[1]?0:1}$=tt(s),O=de[$]=et[$](s);function nt(z,A){return z[0]?xt:Pt}let De=nt(s),Y=De(s),N=s[1]&&We(s);ae=new Rt({$$inline:!0});const st={c:function(){e=C("div"),G(t.$$.fragment),o=R(),h=C("div"),i=C("div"),m.c(),r=R(),f=C("div"),n=C("span"),a=K(s[4]),_=R(),G(u.$$.fragment),l=R(),G(g.$$.fragment),k=R(),D=C("div"),U=C("div"),V=C("h2"),V.textContent=q,B=R(),d=C("div"),b=C("button"),O.c(),Ue=R(),X=C("button"),Oe=K("Очистить"),Pe=R(),oe=C("div"),Y.c(),xe=R(),N&&N.c(),Ve=R(),G(ae.$$.fragment),this.h()},l:function(A){e=E(A,"DIV",{class:!0});var x=S(e);Z(t.$$.fragment,x),o=T(x),h=E(x,"DIV",{class:!0});var re=S(h);i=E(re,"DIV",{class:!0});var ve=S(i);m.l(ve),ve.forEach(p),r=T(re),f=E(re,"DIV",{class:!0});var ot=S(f);n=E(ot,"SPAN",{class:!0});var it=S(n);a=J(it,s[4]),it.forEach(p),ot.forEach(p),re.forEach(p),_=T(x),Z(u.$$.fragment,x),l=T(x),Z(g.$$.fragment,x),k=T(x),D=E(x,"DIV",{class:!0});var _e=S(D);U=E(_e,"DIV",{class:!0});var Se=S(U);V=E(Se,"H2",{class:!0,"data-svelte-h":!0}),me(V)!=="svelte-a1dn70"&&(V.textContent=q),B=T(Se),d=E(Se,"DIV",{class:!0});var Ae=S(d);b=E(Ae,"BUTTON",{class:!0,"aria-label":!0});var rt=S(b);O.l(rt),rt.forEach(p),Ue=T(Ae),X=E(Ae,"BUTTON",{class:!0,"aria-label":!0});var ct=S(X);Oe=J(ct,"Очистить"),ct.forEach(p),Ae.forEach(p),Se.forEach(p),Pe=T(_e),oe=E(_e,"DIV",{class:!0});var ut=S(oe);Y.l(ut),ut.forEach(p),xe=T(_e),N&&N.l(_e),_e.forEach(p),Ve=T(x),Z(ae.$$.fragment,x),x.forEach(p),this.h()},h:function(){y(i,"class","status-item svelte-2q0u1c"),w(i,F,161,2,3858),y(n,"class","hotkey-badge svelte-2q0u1c"),w(n,F,171,3,4245),y(f,"class","status-item svelte-2q0u1c"),w(f,F,170,2,4216),y(h,"class","status-bar svelte-2q0u1c"),w(h,F,160,1,3831),y(V,"class","svelte-2q0u1c"),w(V,F,184,3,4474),y(b,"class",j="record-button "+(s[1]?"recording":"")+" svelte-2q0u1c"),b.disabled=ee=!s[3],y(b,"aria-label",Ce=s[1]?"Остановить запись":"Начать запись"),w(b,F,186,4,4531),y(X,"class","clear-button svelte-2q0u1c"),X.disabled=Be=!s[0],y(X,"aria-label","Очистить"),w(X,F,200,4,4971),y(d,"class","panel-actions svelte-2q0u1c"),w(d,F,185,3,4499),y(U,"class","panel-header svelte-2q0u1c"),w(U,F,183,2,4444),y(oe,"class","transcription-content svelte-2q0u1c"),w(oe,F,210,2,5154),y(D,"class","transcription-panel svelte-2q0u1c"),w(D,F,182,1,4408),y(e,"class","dashboard svelte-2q0u1c"),w(e,F,155,0,3748)},m:function(A,x){L(A,e,x),W(t,e,null),v(e,o),v(e,h),v(h,i),fe[c].m(i,null),v(h,r),v(h,f),v(f,n),v(n,a),v(e,_),W(u,e,null),v(e,l),W(g,e,null),v(e,k),v(e,D),v(D,U),v(U,V),v(U,B),v(U,d),v(d,b),de[$].m(b,null),v(d,Ue),v(d,X),v(X,Oe),v(D,Pe),v(D,oe),Y.m(oe,null),v(D,xe),N&&N.m(D,null),v(e,Ve),W(ae,e,null),ie=!0,Fe||(Xe=[Ee(b,"click",s[5],!1),Ee(X,"click",s[6],!1)],Fe=!0)},p:function(A,[x]){let re=c;c=Ze(A),c!==re&&(ue(),P(fe[re],1,1,()=>{fe[re]=null}),le(),m=fe[c],m||(m=fe[c]=Ye[c](A),m.c()),I(m,1),m.m(i,null));let ve=$;$=tt(A),$!==ve&&(ue(),P(de[ve],1,1,()=>{de[ve]=null}),le(),O=de[$],O||(O=de[$]=et[$](A),O.c()),I(O,1),O.m(b,null)),(!ie||x&2&&j!==(j="record-button "+(A[1]?"recording":"")+" svelte-2q0u1c"))&&y(b,"class",j),(!ie||x&8&&ee!==(ee=!A[3]))&&mt(b,"disabled",ee),(!ie||x&2&&Ce!==(Ce=A[1]?"Остановить запись":"Начать запись"))&&y(b,"aria-label",Ce),(!ie||x&1&&Be!==(Be=!A[0]))&&mt(X,"disabled",Be),De===(De=nt(A))&&Y?Y.p(A,x):(Y.d(1),Y=De(A),Y&&(Y.c(),Y.m(oe,null))),A[1]?N?N.p(A,x):(N=We(A),N.c(),N.m(D,null)):N&&(N.d(1),N=null)},i:function(A){ie||(I(t.$$.fragment,A),I(m),I(u.$$.fragment,A),I(g.$$.fragment,A),I(O),I(ae.$$.fragment,A),ie=!0)},o:function(A){P(t.$$.fragment,A),P(m),P(u.$$.fragment,A),P(g.$$.fragment,A),P(O),P(ae.$$.fragment,A),ie=!1},d:function(A){A&&p(e),H(t),fe[c].d(),H(u),H(g),de[$].d(),Y.d(),N&&N.d(),H(ae),Fe=!1,Lt(Xe)}};return M("SvelteRegisterBlock",{block:st,id:ze.name,type:"component",source:"",ctx:s}),st}function sn(s,e,t){let o,h,i;lt(ke,"transcription"),at(s,ke,d=>t(0,h=d)),lt(pe,"isConnected"),at(s,pe,d=>t(3,i=d));let{$$slots:c={},$$scope:m}=e;Ie("Page",c,[]),console.log("[DEBUG] +page.svelte: Script block started");let r=!1,f=0,n="Ctrl+Super",a="",_=null,u=null,l=null,g=null;ft(async()=>{console.log("[DEBUG] +page.svelte: onMount called"),console.log("[DEBUG] +page.svelte: isTauri() =",we()),console.log("[DEBUG] +page.svelte: Connecting to WebSocket"),wt(),we()&&(console.log("[DEBUG] +page.svelte: Registering hotkey"),await yt("register_hotkey",{shortcut:n,action:"toggle_recording"})!==null&&console.log("Hotkey registered:",n)),console.log("[DEBUG] +page.svelte: Setting up Tauri event listener"),g=kt("hotkey-pressed",d=>{d.payload==="toggle_recording"&&k()})}),dt(()=>{U(),Ct(),g&&g()});async function k(){r?U():await D()}async function D(){try{l=await navigator.mediaDevices.getUserMedia({audio:!0}),_=new AudioContext,u=_.createAnalyser(),_.createMediaStreamSource(l).connect(u);const b=new MediaRecorder(l);b.ondataavailable=$=>{$.data.size>0&&Et($.data)},b.start(100),_t(),t(1,r=!0),V()}catch(d){console.error("Failed to start recording:",d),alert("Не удалось получить доступ к микрофону")}}function U(){l&&(l.getTracks().forEach(d=>d.stop()),l=null),_&&(_.close(),_=null),vt(),t(1,r=!1),t(7,f=0)}function V(){if(!(!r||!u))try{const d=u.frequencyBinCount||256,b=new Uint8Array(d);u.getByteFrequencyData(b);const $=b.reduce((O,j)=>O+j,0);t(7,f=$/b.length/255),requestAnimationFrame(V)}catch(d){console.error("Error updating audio level:",d),t(7,f=0)}}function q(){ke.set(""),t(8,a="")}const B=[];return Object.keys(e).forEach(d=>{!~B.indexOf(d)&&d.slice(0,2)!=="$$"&&d!=="slot"&&nn.warn(`<Page> was created with unknown prop '${d}'`)}),s.$capture_state=()=>({onMount:ft,onDestroy:dt,isTauri:we,safeInvoke:yt,safeListen:kt,isConnected:pe,transcription:ke,connect:wt,disconnect:Yt,sendAudio:Et,cleanup:Ct,updateStats:gt,startRecordingTracking:_t,stopRecordingTracking:vt,Header:At,Banner:$t,QuickAccess:Tt,HistoryList:Rt,Icons:qe,isRecording:r,audioLevel:f,hotkey:n,previousTranscription:a,audioContext:_,analyser:u,mediaStream:l,unlistenHotkey:g,toggleRecording:k,startRecording:D,stopRecording:U,updateAudioLevel:V,clearTranscription:q,safeAudioLevel:o,$transcription:h,$isConnected:i}),s.$inject_state=d=>{"isRecording"in d&&t(1,r=d.isRecording),"audioLevel"in d&&t(7,f=d.audioLevel),"hotkey"in d&&t(4,n=d.hotkey),"previousTranscription"in d&&t(8,a=d.previousTranscription),"audioContext"in d&&(_=d.audioContext),"analyser"in d&&(u=d.analyser),"mediaStream"in d&&(l=d.mediaStream),"unlistenHotkey"in d&&(g=d.unlistenHotkey),"safeAudioLevel"in d&&t(2,o=d.safeAudioLevel)},e&&"$$inject"in e&&s.$inject_state(e.$$inject),s.$$.update=()=>{s.$$.dirty&128&&t(2,o=f||0),s.$$.dirty&257&&h&&(gt(h,a),t(8,a=h))},[h,r,o,i,n,k,q,f,a]}class dn extends Te{constructor(e){super(e),Re(this,e,sn,ze,$e,{}),M("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:ze.name})}}export{dn as component};
