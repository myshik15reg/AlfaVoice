var Lt=Object.defineProperty;var Gt=(n,e,t)=>e in n?Lt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var W=(n,e,t)=>Gt(n,typeof e!="symbol"?e+"":e,t);import{s as Fe,P as ke,b as C,d as D,e as A,f as X,g as F,j as B,t as Y,k as I,Q as Ze,h as ge,v as Ve,c as Le,o as ht,R as mt,r as jt,n as Ht,w as vt}from"./CMwHc_3Q.js";import{S as Ie,i as $e,d as j,c as se,v as Pe,a as _,b as z,t as M,e as $,s as ve,g as ae,f as fe,h as Q,m as J,j as G,k as v,o as De,l as k,n as ee,p as we,q as gt}from"./D9C0UmUm.js";import{g as Wt}from"./D0QH3NT1.js";import{invoke as zt}from"@tauri-apps/api/core";import{listen as Qt}from"@tauri-apps/api/event";import{d as Jt,w as qe}from"./B8tGgVml.js";import{H as It,s as pt,a as _t,u as Et}from"./CN9hnsMj.js";import{A as Ge,s as Te}from"./D0HF1EDb.js";import{A as bt,I as Oe,C as Kt,G as Xt,b as yt,W as Yt,c as Zt,S as eu,M as tu}from"./Dlq4qvvo.js";async function je(){try{return typeof window<"u"&&"__TAURI__"in window&&window.__TAURI__?(console.log("[DEBUG] tauri.ts: isTauri() = true"),!0):(console.log("[DEBUG] tauri.ts: isTauri() = false (no __TAURI__ in window)"),!1)}catch{return console.log("[DEBUG] tauri.ts: isTauri() = false (exception)"),!1}}async function kt(n,e){console.log(`[DEBUG] tauri.ts: safeInvoke('${n}') called`);try{return console.log(`[DEBUG] tauri.ts: Invoking command '${n}' with args:`,e),await zt(n,e)}catch(t){return console.error(`[Tauri] Failed to invoke ${n}:`,t),null}}async function wt(n,e){console.log(`[DEBUG] tauri.ts: safeListen('${n}') called`);try{console.log(`[DEBUG] tauri.ts: Listening to event '${n}'`);const t=await Qt(n,e);return()=>{t()}}catch(t){return console.error(`[Tauri] Failed to listen to ${n}:`,t),()=>{}}}class uu{constructor(e={}){W(this,"ws",null);W(this,"url");W(this,"reconnectInterval");W(this,"maxReconnectAttempts");W(this,"reconnectAttempts",0);W(this,"reconnectTimer",null);W(this,"isManualClose",!1);W(this,"lastErrorLogged",0);W(this,"pingInterval",null);W(this,"pingIntervalMs",3e4);W(this,"onOpenCallback",null);W(this,"onCloseCallback",null);W(this,"onErrorCallback",null);W(this,"onMessageCallback",null);this.url=e.url||"ws://localhost:8081/ws",this.reconnectInterval=e.reconnectInterval||5e3,this.maxReconnectAttempts=e.maxReconnectAttempts||10}connect(){this.ws&&this.ws.readyState===WebSocket.OPEN||(this.isManualClose=!1,this.ws=new WebSocket(this.url),this.ws.onopen=()=>{console.log("[Socket] Connected to",this.url),this.reconnectAttempts=0,this.startPing(),this.onOpenCallback&&this.onOpenCallback()},this.ws.onclose=e=>{console.log("[Socket] Disconnected",e.code,e.reason),this.stopPing(),this.onCloseCallback&&this.onCloseCallback(),!this.isManualClose&&this.reconnectAttempts<this.maxReconnectAttempts&&this.scheduleReconnect()},this.ws.onerror=e=>{const t=Date.now();t-this.lastErrorLogged>5e3&&(console.warn("[Socket] Connection error (server may be offline)"),this.lastErrorLogged=t),this.onErrorCallback&&this.onErrorCallback(e)},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);if(t.type==="pong"){console.log("[Socket] Pong received");return}this.onMessageCallback&&this.onMessageCallback(t)}catch(t){console.error("[Socket] Failed to parse message:",t)}})}disconnect(){this.isManualClose=!0,this.stopPing(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(),this.ws=null)}sendText(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN){console.warn("[Socket] Cannot send message: not connected");return}this.ws.send(e)}sendBinary(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN){console.warn("[Socket] Cannot send binary data: not connected");return}this.ws.send(e)}sendAudio(e){e.arrayBuffer().then(t=>{this.sendBinary(t)})}startPing(){this.stopPing(),this.pingInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const e={type:"ping"};this.ws.send(JSON.stringify(e)),console.log("[Socket] Ping sent")}},this.pingIntervalMs)}stopPing(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=null)}scheduleReconnect(){this.reconnectTimer||(this.reconnectAttempts++,console.log(`[Socket] Reconnecting in ${this.reconnectInterval}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.reconnectTimer=null,this.connect()},this.reconnectInterval))}isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}getReadyState(){return this.ws?.readyState??WebSocket.CLOSED}onOpen(e){this.onOpenCallback=e}onClose(e){this.onCloseCallback=e}onError(e){this.onErrorCallback=e}onMessage(e){this.onMessageCallback=e}clearCallbacks(){this.onOpenCallback=null,this.onCloseCallback=null,this.onErrorCallback=null,this.onMessageCallback=null}}function nu(n){return new uu(n)}const oe=nu({url:"ws://localhost:8081/ws",reconnectInterval:5e3,maxReconnectAttempts:10}),ye=qe(!1),Ce=qe(""),et=qe(null);Jt(ye,n=>n?"connected":"disconnected");oe.onOpen(()=>{ye.set(!0),et.set(null)});oe.onClose(()=>{ye.set(!1)});oe.onError(n=>{et.set("Connection error")});oe.onMessage(n=>{n.type==="transcription"?Ce.set(n.text):n.type==="error"&&et.set(n.message)});function Ct(){oe.connect()}function su(){oe.disconnect()}function Dt(n){oe.sendAudio(n)}function Bt(){oe.clearCallbacks(),oe.disconnect()}function ou(){const{subscribe:n,update:e,set:t}=qe({recordings:[]});return{subscribe:n,addRecording:(s,d)=>{e(o=>({recordings:[{id:crypto.randomUUID(),timestamp:Date.now(),transcription:s,duration:d},...o.recordings]}))},deleteRecording:s=>{e(d=>({recordings:d.recordings.filter(o=>o.id!==s)}))},clearRecordings:()=>{t({recordings:[]})}}}const St=ou(),be="C:/Users/Евгений/Documents/AlfaVoice/client/src/lib/components/Banner.svelte";function He(n){let e,t,s,d,o,i,h,c,f,u,a,p,r,l,g,b;var y=bt;function T(P,w){return{props:{size:18},$$inline:!0}}y&&(r=se(y,T()));const N={c:function(){e=B("div"),t=B("div"),s=B("h2"),d=Y(n[0]),o=I(),i=B("p"),h=Y(n[1]),c=I(),f=B("button"),u=B("span"),a=Y(n[2]),p=I(),r&&Q(r.$$.fragment),this.h()},l:function(w){e=D(w,"DIV",{class:!0});var E=A(e);t=D(E,"DIV",{class:!0});var S=A(t);s=D(S,"H2",{class:!0});var q=A(s);d=X(q,n[0]),q.forEach(_),o=F(S),i=D(S,"P",{class:!0});var O=A(i);h=X(O,n[1]),O.forEach(_),S.forEach(_),c=F(E),f=D(E,"BUTTON",{class:!0});var m=A(f);u=D(m,"SPAN",{});var x=A(u);a=X(x,n[2]),x.forEach(_),p=F(m),r&&ee(r.$$.fragment,m),m.forEach(_),E.forEach(_),this.h()},h:function(){k(s,"class","banner-title svelte-198123s"),C(s,be,13,2,841),k(i,"class","banner-description svelte-198123s"),C(i,be,14,2,881),k(t,"class","banner-content svelte-198123s"),C(t,be,12,1,810),C(u,be,17,2,1016),k(f,"class","banner-button svelte-198123s"),C(f,be,16,1,938),k(e,"class","banner svelte-198123s"),C(e,be,11,0,788)},m:function(w,E){G(w,e,E),v(e,t),v(t,s),v(s,d),v(t,o),v(t,i),v(i,h),v(e,c),v(e,f),v(f,u),v(u,a),v(f,p),r&&J(r,f,null),l=!0,g||(b=De(f,"click",n[4],!1,!1,!1),g=!0)},p:function(w,[E]){if((!l||E&1)&&ve(d,w[0]),(!l||E&2)&&ve(h,w[1]),(!l||E&4)&&ve(a,w[2]),y!==(y=bt)){if(r){ae();const S=r;M(S.$$.fragment,1,0,()=>{z(S,1)}),fe()}y?(r=se(y,T()),Q(r.$$.fragment),$(r.$$.fragment,1),J(r,f,null)):r=null}},i:function(w){l||(r&&$(r.$$.fragment,w),l=!0)},o:function(w){r&&M(r.$$.fragment,w),l=!1},d:function(w){w&&_(e),r&&z(r),g=!1,b()}};return j("SvelteRegisterBlock",{block:N,id:He.name,type:"component",source:"",ctx:n}),N}function iu(n,e,t){let{$$slots:s={},$$scope:d}=e;Pe("Banner",s,[]);const o=ke();let{title:i="Настройте звучание AlfaVoice"}=e,{description:h="Адаптируйте голосовой ввод под ваш стиль письма и профессиональный словарь."}=e,{buttonText:c="Начать"}=e;const f=["title","description","buttonText"];Object.keys(e).forEach(a=>{!~f.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<Banner> was created with unknown prop '${a}'`)});const u=()=>o("start-recording");return n.$$set=a=>{"title"in a&&t(0,i=a.title),"description"in a&&t(1,h=a.description),"buttonText"in a&&t(2,c=a.buttonText)},n.$capture_state=()=>({createEventDispatcher:ke,Icons:Oe,dispatch:o,title:i,description:h,buttonText:c}),n.$inject_state=a=>{"title"in a&&t(0,i=a.title),"description"in a&&t(1,h=a.description),"buttonText"in a&&t(2,c=a.buttonText)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[i,h,c,o,u]}class $t extends Ie{constructor(e){super(e),$e(this,e,iu,He,Fe,{title:0,description:1,buttonText:2}),j("SvelteRegisterComponent",{component:this,tagName:"Banner",options:e,id:He.name})}get title(){throw new Error("<Banner>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set title(e){throw new Error("<Banner>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get description(){throw new Error("<Banner>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set description(e){throw new Error("<Banner>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get buttonText(){throw new Error("<Banner>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set buttonText(e){throw new Error("<Banner>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const le="C:/Users/Евгений/Documents/AlfaVoice/client/src/lib/components/QuickAccess.svelte";function At(n,e,t){const s=n.slice();return s[4]=e[t],s}function We(n){let e,t,s,d,o,i,h=n[4].title+"",c,f,u,a=n[4].description+"",p,r,l,g,b;var y=n[4].icon;function T(w,E){return{props:{size:24},$$inline:!0}}y&&(s=se(y,T()));function N(){return n[2](n[4])}const P={c:function(){e=B("button"),t=B("div"),s&&Q(s.$$.fragment),d=I(),o=B("div"),i=B("h4"),c=Y(h),f=I(),u=B("p"),p=Y(a),r=I(),this.h()},l:function(E){e=D(E,"BUTTON",{class:!0});var S=A(e);t=D(S,"DIV",{class:!0});var q=A(t);s&&ee(s.$$.fragment,q),q.forEach(_),d=F(S),o=D(S,"DIV",{class:!0});var O=A(o);i=D(O,"H4",{class:!0});var m=A(i);c=X(m,h),m.forEach(_),f=F(O),u=D(O,"P",{class:!0});var x=A(u);p=X(x,a),x.forEach(_),O.forEach(_),r=F(S),S.forEach(_),this.h()},h:function(){k(t,"class","card-icon svelte-1bcq7he"),C(t,le,38,4,955),k(i,"class","card-title svelte-1bcq7he"),C(i,le,42,5,1079),k(u,"class","card-description svelte-1bcq7he"),C(u,le,43,5,1125),k(o,"class","card-content svelte-1bcq7he"),C(o,le,41,4,1047),k(e,"class","card svelte-1bcq7he"),C(e,le,37,3,891)},m:function(E,S){G(E,e,S),v(e,t),s&&J(s,t,null),v(e,d),v(e,o),v(o,i),v(i,c),v(o,f),v(o,u),v(u,p),v(e,r),l=!0,g||(b=De(e,"click",N,!1,!1,!1),g=!0)},p:function(E,S){if(n=E,y!==(y=n[4].icon)){if(s){ae();const q=s;M(q.$$.fragment,1,0,()=>{z(q,1)}),fe()}y?(s=se(y,T()),Q(s.$$.fragment),$(s.$$.fragment,1),J(s,t,null)):s=null}},i:function(E){l||(s&&$(s.$$.fragment,E),l=!0)},o:function(E){s&&M(s.$$.fragment,E),l=!1},d:function(E){E&&_(e),s&&z(s),g=!1,b()}};return j("SvelteRegisterBlock",{block:P,id:We.name,type:"each",source:"(26:2) {#each cards as card}",ctx:n}),P}function ze(n){let e,t,s="Вернуться в поток",d,o,i,h=we(n[0]),c=[];for(let a=0;a<h.length;a+=1)c[a]=We(At(n,h,a));const f=a=>M(c[a],1,1,()=>{c[a]=null}),u={c:function(){e=B("section"),t=B("h3"),t.textContent=s,d=I(),o=B("div");for(let p=0;p<c.length;p+=1)c[p].c();this.h()},l:function(p){e=D(p,"SECTION",{class:!0});var r=A(e);t=D(r,"H3",{class:!0,"data-svelte-h":!0}),ge(t)!=="svelte-wibglv"&&(t.textContent=s),d=F(r),o=D(r,"DIV",{class:!0});var l=A(o);for(let g=0;g<c.length;g+=1)c[g].l(l);l.forEach(_),r.forEach(_),this.h()},h:function(){k(t,"class","section-title svelte-1bcq7he"),C(t,le,34,1,789),k(o,"class","cards-grid svelte-1bcq7he"),C(o,le,35,1,839),k(e,"class","quick-access svelte-1bcq7he"),C(e,le,33,0,757)},m:function(p,r){G(p,e,r),v(e,t),v(e,d),v(e,o);for(let l=0;l<c.length;l+=1)c[l]&&c[l].m(o,null);i=!0},p:function(p,[r]){if(r&3){h=we(p[0]);let l;for(l=0;l<h.length;l+=1){const g=At(p,h,l);c[l]?(c[l].p(g,r),$(c[l],1)):(c[l]=We(g),c[l].c(),$(c[l],1),c[l].m(o,null))}for(ae(),l=h.length;l<c.length;l+=1)f(l);fe()}},i:function(p){if(!i){for(let r=0;r<h.length;r+=1)$(c[r]);i=!0}},o:function(p){c=c.filter(Boolean);for(let r=0;r<c.length;r+=1)M(c[r]);i=!1},d:function(p){p&&_(e),Ze(c,p)}};return j("SvelteRegisterBlock",{block:u,id:ze.name,type:"component",source:"",ctx:n}),u}function ru(n,e,t){let{$$slots:s={},$$scope:d}=e;Pe("QuickAccess",s,[]);const o=ke(),i=[{id:"code",title:"Code",description:"Голосовой ввод для программирования",icon:Kt},{id:"chrome",title:"Chrome",description:"Быстрые заметки в браузере",icon:Xt}];function h(u){o("select",{cardId:u})}const c=[];Object.keys(e).forEach(u=>{!~c.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&console.warn(`<QuickAccess> was created with unknown prop '${u}'`)});const f=u=>h(u.id);return n.$capture_state=()=>({createEventDispatcher:ke,Icons:Oe,dispatch:o,cards:i,onCardClick:h}),[i,h,f]}class Pt extends Ie{constructor(e){super(e),$e(this,e,ru,ze,Fe,{}),j("SvelteRegisterComponent",{component:this,tagName:"QuickAccess",options:e,id:ze.name})}}const ne="C:/Users/Евгений/Documents/AlfaVoice/client/src/lib/components/HistoryList.svelte";function Rt(n,e,t){const s=n.slice();return s[4]=e[t],s}function Tt(n,e,t){const s=n.slice();return s[7]=e[t],s}function Qe(n){let e,t,s,d,o,i=n[7].time+"",h,c,f,u=n[7].text+"",a,p,r,l,g;var b=yt;function y(P,w){return{props:{size:16,class:"entry-icon"},$$inline:!0}}b&&(t=se(b,y()));function T(){return n[2](n[7])}const N={c:function(){e=B("button"),t&&Q(t.$$.fragment),s=I(),d=B("div"),o=B("span"),h=Y(i),c=I(),f=B("span"),a=Y(u),p=I(),this.h()},l:function(w){e=D(w,"BUTTON",{class:!0});var E=A(e);t&&ee(t.$$.fragment,E),s=F(E),d=D(E,"DIV",{class:!0});var S=A(d);o=D(S,"SPAN",{class:!0});var q=A(o);h=X(q,i),q.forEach(_),c=F(S),f=D(S,"SPAN",{class:!0});var O=A(f);a=X(O,u),O.forEach(_),S.forEach(_),p=F(E),E.forEach(_),this.h()},h:function(){k(o,"class","entry-time svelte-1kxaayy"),C(o,ne,52,8,2248),k(f,"class","entry-text svelte-1kxaayy"),C(f,ne,53,8,2301),k(d,"class","entry-content svelte-1kxaayy"),C(d,ne,51,7,2212),k(e,"class","entry-item svelte-1kxaayy"),C(e,ne,49,6,2061)},m:function(w,E){G(w,e,E),t&&J(t,e,null),v(e,s),v(e,d),v(d,o),v(o,h),v(d,c),v(d,f),v(f,a),v(e,p),r=!0,l||(g=De(e,"click",T,!1,!1,!1),l=!0)},p:function(w,E){if(n=w,b!==(b=yt)){if(t){ae();const S=t;M(S.$$.fragment,1,0,()=>{z(S,1)}),fe()}b?(t=se(b,y()),Q(t.$$.fragment),$(t.$$.fragment,1),J(t,e,s)):t=null}(!r||E&1)&&i!==(i=n[7].time+"")&&ve(h,i),(!r||E&1)&&u!==(u=n[7].text+"")&&ve(a,u)},i:function(w){r||(t&&$(t.$$.fragment,w),r=!0)},o:function(w){t&&M(t.$$.fragment,w),r=!1},d:function(w){w&&_(e),t&&z(t),l=!1,g()}};return j("SvelteRegisterBlock",{block:N,id:Qe.name,type:"each",source:"(33:5) {#each group.entries as entry}",ctx:n}),N}function Je(n){let e,t,s=n[4].date+"",d,o,i,h,c,f=we(n[4].entries),u=[];for(let r=0;r<f.length;r+=1)u[r]=Qe(Tt(n,f,r));const a=r=>M(u[r],1,1,()=>{u[r]=null}),p={c:function(){e=B("div"),t=B("h4"),d=Y(s),o=I(),i=B("div");for(let l=0;l<u.length;l+=1)u[l].c();h=I(),this.h()},l:function(l){e=D(l,"DIV",{class:!0});var g=A(e);t=D(g,"H4",{class:!0});var b=A(t);d=X(b,s),b.forEach(_),o=F(g),i=D(g,"DIV",{class:!0});var y=A(i);for(let T=0;T<u.length;T+=1)u[T].l(y);y.forEach(_),h=F(g),g.forEach(_),this.h()},h:function(){k(t,"class","group-date svelte-1kxaayy"),C(t,ne,46,4,1947),k(i,"class","entries-list svelte-1kxaayy"),C(i,ne,47,4,1992),k(e,"class","history-group svelte-1kxaayy"),C(e,ne,45,3,1915)},m:function(l,g){G(l,e,g),v(e,t),v(t,d),v(e,o),v(e,i);for(let b=0;b<u.length;b+=1)u[b]&&u[b].m(i,null);v(e,h),c=!0},p:function(l,g){if((!c||g&1)&&s!==(s=l[4].date+"")&&ve(d,s),g&3){f=we(l[4].entries);let b;for(b=0;b<f.length;b+=1){const y=Tt(l,f,b);u[b]?(u[b].p(y,g),$(u[b],1)):(u[b]=Qe(y),u[b].c(),$(u[b],1),u[b].m(i,null))}for(ae(),b=f.length;b<u.length;b+=1)a(b);fe()}},i:function(l){if(!c){for(let g=0;g<f.length;g+=1)$(u[g]);c=!0}},o:function(l){u=u.filter(Boolean);for(let g=0;g<u.length;g+=1)M(u[g]);c=!1},d:function(l){l&&_(e),Ze(u,l)}};return j("SvelteRegisterBlock",{block:p,id:Je.name,type:"each",source:"(29:2) {#each history as group}",ctx:n}),p}function Ke(n){let e,t,s="История",d,o,i,h=we(n[0]),c=[];for(let a=0;a<h.length;a+=1)c[a]=Je(Rt(n,h,a));const f=a=>M(c[a],1,1,()=>{c[a]=null}),u={c:function(){e=B("section"),t=B("h3"),t.textContent=s,d=I(),o=B("div");for(let p=0;p<c.length;p+=1)c[p].c();this.h()},l:function(p){e=D(p,"SECTION",{class:!0});var r=A(e);t=D(r,"H3",{class:!0,"data-svelte-h":!0}),ge(t)!=="svelte-ukje9l"&&(t.textContent=s),d=F(r),o=D(r,"DIV",{class:!0});var l=A(o);for(let g=0;g<c.length;g+=1)c[g].l(l);l.forEach(_),r.forEach(_),this.h()},h:function(){k(t,"class","section-title svelte-1kxaayy"),C(t,ne,42,1,1815),k(o,"class","history-content svelte-1kxaayy"),C(o,ne,43,1,1855),k(e,"class","history-list svelte-1kxaayy"),C(e,ne,41,0,1783)},m:function(p,r){G(p,e,r),v(e,t),v(e,d),v(e,o);for(let l=0;l<c.length;l+=1)c[l]&&c[l].m(o,null);i=!0},p:function(p,[r]){if(r&3){h=we(p[0]);let l;for(l=0;l<h.length;l+=1){const g=Rt(p,h,l);c[l]?(c[l].p(g,r),$(c[l],1)):(c[l]=Je(g),c[l].c(),$(c[l],1),c[l].m(o,null))}for(ae(),l=h.length;l<c.length;l+=1)f(l);fe()}},i:function(p){if(!i){for(let r=0;r<h.length;r+=1)$(c[r]);i=!0}},o:function(p){c=c.filter(Boolean);for(let r=0;r<c.length;r+=1)M(c[r]);i=!1},d:function(p){p&&_(e),Ze(c,p)}};return j("SvelteRegisterBlock",{block:u,id:Ke.name,type:"component",source:"",ctx:n}),u}function cu(n,e,t){let{$$slots:s={},$$scope:d}=e;Pe("HistoryList",s,[]);const o=ke();let{history:i=[{date:"Сегодня",entries:[{id:"1",time:"14:30",text:"Создайте новый компонент для боковой панели с навигацией"},{id:"2",time:"12:15",text:"Обновите конфигурацию TailwindCSS для поддержки темной темы"},{id:"3",time:"10:45",text:"Добавьте иконки из библиотеки lucide-svelte"}]},{date:"Вчера",entries:[{id:"4",time:"16:20",text:"Настройте WebSocket соединение с сервером"},{id:"5",time:"14:05",text:"Реализуйте логику записи аудио с микрофона"}]}]}=e;function h(u){o("select",{entryId:u})}const c=["history"];Object.keys(e).forEach(u=>{!~c.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&console.warn(`<HistoryList> was created with unknown prop '${u}'`)});const f=u=>h(u.id);return n.$$set=u=>{"history"in u&&t(0,i=u.history)},n.$capture_state=()=>({createEventDispatcher:ke,Icons:Oe,dispatch:o,history:i,onEntryClick:h}),n.$inject_state=u=>{"history"in u&&t(0,i=u.history)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[i,h,f]}class qt extends Ie{constructor(e){super(e),$e(this,e,cu,Ke,Fe,{history:0}),j("SvelteRegisterComponent",{component:this,tagName:"HistoryList",options:e,id:Ke.name})}get history(){throw new Error("<HistoryList>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set history(e){throw new Error("<HistoryList>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const{console:lu}=Wt,L="C:/Users/Евгений/Documents/AlfaVoice/client/src/routes/+page.svelte";function Ot(n){let e,t,s,d="Сервер отключен",o;var i=Zt;function h(f,u){return{props:{size:16,class:"status-icon disconnected"},$$inline:!0}}i&&(e=se(i,h()));const c={c:function(){e&&Q(e.$$.fragment),t=I(),s=B("span"),s.textContent=d,this.h()},l:function(u){e&&ee(e.$$.fragment,u),t=F(u),s=D(u,"SPAN",{class:!0,"data-svelte-h":!0}),ge(s)!=="svelte-wvxfto"&&(s.textContent=d),this.h()},h:function(){k(s,"class","status-text svelte-2q0u1c"),C(s,L,302,4,10921)},m:function(u,a){e&&J(e,u,a),G(u,t,a),G(u,s,a),o=!0},i:function(u){o||(e&&$(e.$$.fragment,u),o=!0)},o:function(u){e&&M(e.$$.fragment,u),o=!1},d:function(u){u&&(_(t),_(s)),e&&z(e,u)}};return j("SvelteRegisterBlock",{block:c,id:Ot.name,type:"else",source:"(229:3) {:else}",ctx:n}),c}function Mt(n){let e,t,s,d="Сервер подключен",o;var i=Yt;function h(f,u){return{props:{size:16,class:"status-icon connected"},$$inline:!0}}i&&(e=se(i,h()));const c={c:function(){e&&Q(e.$$.fragment),t=I(),s=B("span"),s.textContent=d,this.h()},l:function(u){e&&ee(e.$$.fragment,u),t=F(u),s=D(u,"SPAN",{class:!0,"data-svelte-h":!0}),ge(s)!=="svelte-166aob3"&&(s.textContent=d),this.h()},h:function(){k(s,"class","status-text svelte-2q0u1c"),C(s,L,299,4,10767)},m:function(u,a){e&&J(e,u,a),G(u,t,a),G(u,s,a),o=!0},i:function(u){o||(e&&$(e.$$.fragment,u),o=!0)},o:function(u){e&&M(e.$$.fragment,u),o=!1},d:function(u){u&&(_(t),_(s)),e&&z(e,u)}};return j("SvelteRegisterBlock",{block:c,id:Mt.name,type:"if",source:"(226:3) {#if $isConnected}",ctx:n}),c}function Ut(n){let e,t,s,d="Записать",o;var i=tu;function h(f,u){return{props:{size:18},$$inline:!0}}i&&(e=se(i,h()));const c={c:function(){e&&Q(e.$$.fragment),t=I(),s=B("span"),s.textContent=d,this.h()},l:function(u){e&&ee(e.$$.fragment,u),t=F(u),s=D(u,"SPAN",{"data-svelte-h":!0}),ge(s)!=="svelte-1igdl8d"&&(s.textContent=d),this.h()},h:function(){C(s,L,332,6,11730)},m:function(u,a){e&&J(e,u,a),G(u,t,a),G(u,s,a),o=!0},i:function(u){o||(e&&$(e.$$.fragment,u),o=!0)},o:function(u){e&&M(e.$$.fragment,u),o=!1},d:function(u){u&&(_(t),_(s)),e&&z(e,u)}};return j("SvelteRegisterBlock",{block:c,id:Ut.name,type:"else",source:"(259:5) {:else}",ctx:n}),c}function Nt(n){let e,t,s,d="Остановить",o;var i=eu;function h(f,u){return{props:{size:18},$$inline:!0}}i&&(e=se(i,h()));const c={c:function(){e&&Q(e.$$.fragment),t=I(),s=B("span"),s.textContent=d,this.h()},l:function(u){e&&ee(e.$$.fragment,u),t=F(u),s=D(u,"SPAN",{"data-svelte-h":!0}),ge(s)!=="svelte-1h67wdq"&&(s.textContent=d),this.h()},h:function(){C(s,L,329,6,11633)},m:function(u,a){e&&J(e,u,a),G(u,t,a),G(u,s,a),o=!0},i:function(u){o||(e&&$(e.$$.fragment,u),o=!0)},o:function(u){e&&M(e.$$.fragment,u),o=!1},d:function(u){u&&(_(t),_(s)),e&&z(e,u)}};return j("SvelteRegisterBlock",{block:c,id:Nt.name,type:"if",source:"(256:5) {#if isRecording}",ctx:n}),c}function xt(n){let e,t,s;const d={c:function(){e=B("p"),t=Y("Нажмите кнопку записи или используйте горячую клавишу "),s=Y(n[4]),this.h()},l:function(i){e=D(i,"P",{class:!0});var h=A(e);t=X(h,"Нажмите кнопку записи или используйте горячую клавишу "),s=X(h,n[4]),h.forEach(_),this.h()},h:function(){k(e,"class","placeholder svelte-2q0u1c"),C(e,L,349,4,12067)},m:function(i,h){G(i,e,h),v(e,t),v(e,s)},p:Ht,d:function(i){i&&_(e)}};return j("SvelteRegisterBlock",{block:d,id:xt.name,type:"else",source:"(277:3) {:else}",ctx:n}),d}function Vt(n){let e,t;const s={c:function(){e=B("p"),t=Y(n[0]),this.h()},l:function(o){e=D(o,"P",{class:!0});var i=A(e);t=X(i,n[0]),i.forEach(_),this.h()},h:function(){k(e,"class","svelte-2q0u1c"),C(e,L,347,4,12028)},m:function(o,i){G(o,e,i),v(e,t)},p:function(o,i){i&1&&ve(t,o[0])},d:function(o){o&&_(e)}};return j("SvelteRegisterBlock",{block:s,id:Vt.name,type:"if",source:"(275:3) {#if $transcription}",ctx:n}),s}function Xe(n){let e,t;const s={c:function(){e=B("div"),t=B("div"),this.h()},l:function(o){e=D(o,"DIV",{class:!0});var i=A(e);t=D(i,"DIV",{class:!0,style:!0}),A(t).forEach(_),i.forEach(_),this.h()},h:function(){k(t,"class","audio-level-bar svelte-2q0u1c"),vt(t,"width",n[2]*100+"%"),C(t,L,355,4,12262),k(e,"class","audio-level svelte-2q0u1c"),C(e,L,354,3,12232)},m:function(o,i){G(o,e,i),v(e,t)},p:function(o,i){i&4&&vt(t,"width",o[2]*100+"%")},d:function(o){o&&_(e)}};return j("SvelteRegisterBlock",{block:s,id:Xe.name,type:"if",source:"(282:2) {#if isRecording}",ctx:n}),s}function Ye(n){let e,t,s,d,o,i,h,c,f,u,a,p,r,l,g,b,y,T,N,P="Транскрипция",w,E,S,q,O,m,x,te,ue,V,pe,Be,Me,ie,Ue,Ne,de,re,xe,tt;t=new It({$$inline:!0});const ut=[Mt,Ot],he=[];function nt(K,R){return K[3]?0:1}i=nt(n),h=he[i]=ut[i](n),r=new $t({$$inline:!0}),r.$on("start-recording",n[6]),g=new Pt({$$inline:!0});const st=[Nt,Ut],me=[];function ot(K,R){return K[1]?0:1}q=ot(n),O=me[q]=st[q](n);function it(K,R){return K[0]?Vt:xt}let Se=it(n),Z=Se(n),H=n[1]&&Xe(n);de=new qt({$$inline:!0});const rt={c:function(){e=B("div"),Q(t.$$.fragment),s=I(),d=B("div"),o=B("div"),h.c(),c=I(),f=B("div"),u=B("span"),a=Y(n[4]),p=I(),Q(r.$$.fragment),l=I(),Q(g.$$.fragment),b=I(),y=B("div"),T=B("div"),N=B("h2"),N.textContent=P,w=I(),E=B("div"),S=B("button"),O.c(),ue=I(),V=B("button"),pe=Y("Очистить"),Me=I(),ie=B("div"),Z.c(),Ue=I(),H&&H.c(),Ne=I(),Q(de.$$.fragment),this.h()},l:function(R){e=D(R,"DIV",{class:!0});var U=A(e);ee(t.$$.fragment,U),s=F(U),d=D(U,"DIV",{class:!0});var ce=A(d);o=D(ce,"DIV",{class:!0});var _e=A(o);h.l(_e),_e.forEach(_),c=F(ce),f=D(ce,"DIV",{class:!0});var ct=A(f);u=D(ct,"SPAN",{class:!0});var lt=A(u);a=X(lt,n[4]),lt.forEach(_),ct.forEach(_),ce.forEach(_),p=F(U),ee(r.$$.fragment,U),l=F(U),ee(g.$$.fragment,U),b=F(U),y=D(U,"DIV",{class:!0});var Ee=A(y);T=D(Ee,"DIV",{class:!0});var Ae=A(T);N=D(Ae,"H2",{class:!0,"data-svelte-h":!0}),ge(N)!=="svelte-a1dn70"&&(N.textContent=P),w=F(Ae),E=D(Ae,"DIV",{class:!0});var Re=A(E);S=D(Re,"BUTTON",{class:!0,"aria-label":!0});var at=A(S);O.l(at),at.forEach(_),ue=F(Re),V=D(Re,"BUTTON",{class:!0,"aria-label":!0});var ft=A(V);pe=X(ft,"Очистить"),ft.forEach(_),Re.forEach(_),Ae.forEach(_),Me=F(Ee),ie=D(Ee,"DIV",{class:!0});var dt=A(ie);Z.l(dt),dt.forEach(_),Ue=F(Ee),H&&H.l(Ee),Ee.forEach(_),Ne=F(U),ee(de.$$.fragment,U),U.forEach(_),this.h()},h:function(){k(o,"class","status-item svelte-2q0u1c"),C(o,L,296,2,10632),k(u,"class","hotkey-badge svelte-2q0u1c"),C(u,L,306,3,11019),k(f,"class","status-item svelte-2q0u1c"),C(f,L,305,2,10990),k(d,"class","status-bar svelte-2q0u1c"),C(d,L,295,1,10605),k(N,"class","svelte-2q0u1c"),C(N,L,319,3,11284),k(S,"class",m="record-button "+(n[1]?"recording":"")+" svelte-2q0u1c"),S.disabled=x=!n[3],k(S,"aria-label",te=n[1]?"Остановить запись":"Начать запись"),C(S,L,321,4,11341),k(V,"class","clear-button svelte-2q0u1c"),V.disabled=Be=!n[0],k(V,"aria-label","Очистить"),C(V,L,335,4,11781),k(E,"class","panel-actions svelte-2q0u1c"),C(E,L,320,3,11309),k(T,"class","panel-header svelte-2q0u1c"),C(T,L,318,2,11254),k(ie,"class","transcription-content svelte-2q0u1c"),C(ie,L,345,2,11964),k(y,"class","transcription-panel svelte-2q0u1c"),C(y,L,317,1,11218),k(e,"class","dashboard svelte-2q0u1c"),C(e,L,290,0,10522)},m:function(R,U){G(R,e,U),J(t,e,null),v(e,s),v(e,d),v(d,o),he[i].m(o,null),v(d,c),v(d,f),v(f,u),v(u,a),v(e,p),J(r,e,null),v(e,l),J(g,e,null),v(e,b),v(e,y),v(y,T),v(T,N),v(T,w),v(T,E),v(E,S),me[q].m(S,null),v(E,ue),v(E,V),v(V,pe),v(y,Me),v(y,ie),Z.m(ie,null),v(y,Ue),H&&H.m(y,null),v(e,Ne),J(de,e,null),re=!0,xe||(tt=[De(S,"click",n[5],!1,!1,!1),De(V,"click",n[7],!1,!1,!1)],xe=!0)},p:function(R,[U]){let ce=i;i=nt(R),i!==ce&&(ae(),M(he[ce],1,1,()=>{he[ce]=null}),fe(),h=he[i],h||(h=he[i]=ut[i](R),h.c()),$(h,1),h.m(o,null));let _e=q;q=ot(R),q!==_e&&(ae(),M(me[_e],1,1,()=>{me[_e]=null}),fe(),O=me[q],O||(O=me[q]=st[q](R),O.c()),$(O,1),O.m(S,null)),(!re||U&2&&m!==(m="record-button "+(R[1]?"recording":"")+" svelte-2q0u1c"))&&k(S,"class",m),(!re||U&8&&x!==(x=!R[3]))&&gt(S,"disabled",x),(!re||U&2&&te!==(te=R[1]?"Остановить запись":"Начать запись"))&&k(S,"aria-label",te),(!re||U&1&&Be!==(Be=!R[0]))&&gt(V,"disabled",Be),Se===(Se=it(R))&&Z?Z.p(R,U):(Z.d(1),Z=Se(R),Z&&(Z.c(),Z.m(ie,null))),R[1]?H?H.p(R,U):(H=Xe(R),H.c(),H.m(y,null)):H&&(H.d(1),H=null)},i:function(R){re||($(t.$$.fragment,R),$(h),$(r.$$.fragment,R),$(g.$$.fragment,R),$(O),$(de.$$.fragment,R),re=!0)},o:function(R){M(t.$$.fragment,R),M(h),M(r.$$.fragment,R),M(g.$$.fragment,R),M(O),M(de.$$.fragment,R),re=!1},d:function(R){R&&_(e),z(t),he[i].d(),z(r),z(g),me[q].d(),Z.d(),H&&H.d(),z(de),xe=!1,jt(tt)}};return j("SvelteRegisterBlock",{block:rt,id:Ye.name,type:"component",source:"",ctx:n}),rt}function Ft(){const n=["audio/webm;codecs=opus","audio/webm","audio/ogg;codecs=opus","audio/ogg"];for(const e of n)if(MediaRecorder.isTypeSupported(e))return console.log("[DEBUG] Supported MIME type:",e),e;return console.warn("[WARN] No supported MIME type found"),null}function au(n,e,t){let s,d,o,i;Ve(Ce,"transcription"),Le(n,Ce,m=>t(0,d=m)),Ve(ye,"isConnected"),Le(n,ye,m=>t(3,o=m)),Ve(Te,"settingsStore"),Le(n,Te,m=>t(16,i=m));let{$$slots:h={},$$scope:c}=e;Pe("Page",h,[]),console.log("[DEBUG] +page.svelte: Script block started");let f=!1,u=0,a="Ctrl+Super",p=null,r="",l=null,g=null,b=null,y=null,T=null;ht(async()=>{console.log("[DEBUG] +page.svelte: onMount called"),console.log("[DEBUG] +page.svelte: isTauri() =",await je()),console.log("[DEBUG] +page.svelte: Connecting to WebSocket"),Ct(),await je()&&(console.log("[DEBUG] +page.svelte: Registering hotkey"),await kt("register_hotkey",{shortcut:a,action:"toggle_recording"})!==null&&console.log("Hotkey registered:",a)),console.log("[DEBUG] +page.svelte: Setting up Tauri event listener"),T=await wt("hotkey-pressed",m=>{m.payload==="toggle_recording"&&N()})}),mt(()=>{E(),Bt(),T&&T()});async function N(){f?E():await w()}async function P(m){if(!m)return null;try{return(await new Ge().getDevices()).some(V=>V.deviceId===m)?m:(console.warn("[WARN] Selected device ID not found in available devices:",m),Te.setSelectedMicrophoneId(null),null)}catch(x){return console.error("[ERROR] Failed to validate device ID:",x),null}}async function w(){try{const m=i.selectedMicrophoneId;console.log("[DEBUG] Selected microphone ID:",m);const x=await P(m);console.log("[DEBUG] Validated device ID:",x),y=new Ge({deviceId:x||void 0,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}),await y.initialize(),console.log("[DEBUG] Audio capture initialized successfully"),b=y.mediaStream,l=y.audioContext,g=y.analyser;const te=Ft();if(!te){alert("Ваш браузер не поддерживает ни один из поддерживаемых форматов аудио. Пожалуйста, используйте современный браузер (Chrome, Firefox, Edge)."),E();return}if(!b)throw new Error("Media stream is null");const ue=new MediaRecorder(b,{mimeType:te});ue.onerror=V=>{const pe=V;console.error("[ERROR] MediaRecorder error:",pe.error),alert(`Ошибка записи аудио: ${pe.error?.message||"Неизвестная ошибка"}`),E()},ue.ondataavailable=V=>{if(V.data.size>0){if(!o){console.warn("[WARN] WebSocket not connected, audio data lost"),alert("Сервер отключен. Аудиоданные не будут отправлены. Пожалуйста, подключитесь к серверу.");return}Dt(V.data)}},ue.start(100),_t(),p=Date.now(),t(1,f=!0),S()}catch(m){if(console.error("Failed to start recording:",m),m instanceof Error)switch(m.name){case"NotAllowedError":alert("Доступ к микрофону запрещён. Пожалуйста, разрешите доступ в настройках браузера.");break;case"NotFoundError":alert("Микрофон не найден. Пожалуйста, подключите микрофон и попробуйте снова.");break;case"NotReadableError":alert("Не удалось получить доступ к микрофону. Возможно, другое приложение использует микрофон.");break;case"OverconstrainedError":alert("Устройство не соответствует требуемым ограничениям. Попробуйте другой микрофон.");break;case"SecurityError":alert("Ошибка безопасности при доступе к микрофону. Проверьте настройки браузера.");break;default:alert(`Не удалось получить доступ к микрофону: ${m.message}`)}else alert("Не удалось получить доступ к микрофону: неизвестная ошибка")}}function E(){if(y?(y.cleanup(),y=null):(b&&(b.getTracks().forEach(m=>m.stop()),b=null),l&&(l.close(),l=null)),pt(),p&&d){const m=(Date.now()-p)/1e3;St.addRecording(d,m)}p=null,t(1,f=!1),t(8,u=0)}function S(){if(!(!f||!g))try{const m=g.frequencyBinCount||256,x=new Uint8Array(m);g.getByteFrequencyData(x);const te=x.reduce((ue,V)=>ue+V,0);t(8,u=te/x.length/255),requestAnimationFrame(S)}catch(m){console.error("Error updating audio level:",m),t(8,u=0)}}function q(){Ce.set(""),t(9,r="")}const O=[];return Object.keys(e).forEach(m=>{!~O.indexOf(m)&&m.slice(0,2)!=="$$"&&m!=="slot"&&lu.warn(`<Page> was created with unknown prop '${m}'`)}),n.$capture_state=()=>({onMount:ht,onDestroy:mt,isTauri:je,safeInvoke:kt,safeListen:wt,isConnected:ye,transcription:Ce,connect:Ct,disconnect:su,sendAudio:Dt,cleanup:Bt,updateStats:Et,startRecordingTracking:_t,stopRecordingTracking:pt,recordingsStore:St,settingsStore:Te,AudioCapture:Ge,Header:It,Banner:$t,QuickAccess:Pt,HistoryList:qt,Icons:Oe,isRecording:f,audioLevel:u,hotkey:a,recordingStartTime:p,previousTranscription:r,audioContext:l,analyser:g,mediaStream:b,audioCapture:y,unlistenHotkey:T,toggleRecording:N,getSupportedMimeType:Ft,validateDeviceId:P,startRecording:w,stopRecording:E,updateAudioLevel:S,clearTranscription:q,safeAudioLevel:s,$transcription:d,$isConnected:o,$settingsStore:i}),n.$inject_state=m=>{"isRecording"in m&&t(1,f=m.isRecording),"audioLevel"in m&&t(8,u=m.audioLevel),"hotkey"in m&&t(4,a=m.hotkey),"recordingStartTime"in m&&(p=m.recordingStartTime),"previousTranscription"in m&&t(9,r=m.previousTranscription),"audioContext"in m&&(l=m.audioContext),"analyser"in m&&(g=m.analyser),"mediaStream"in m&&(b=m.mediaStream),"audioCapture"in m&&(y=m.audioCapture),"unlistenHotkey"in m&&(T=m.unlistenHotkey),"safeAudioLevel"in m&&t(2,s=m.safeAudioLevel)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),n.$$.update=()=>{n.$$.dirty&256&&t(2,s=u||0),n.$$.dirty&513&&d&&(Et(d,r),t(9,r=d))},[d,f,s,o,a,N,w,q,u,r]}class yu extends Ie{constructor(e){super(e),$e(this,e,au,Ye,Fe,{}),j("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Ye.name})}}export{yu as P};
