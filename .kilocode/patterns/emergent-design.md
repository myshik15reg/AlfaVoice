# Emergent Design

> Архитектура не проектируется заранее целиком (Big Design Up Front), а рождается эволюционно через тесты, рефакторинг и следование принципам простоты.

## Ключевые принципы

### 1. YAGNI (You Ain't Gonna Need It)
**Правило:** Не пиши код, который не нужен прямо сейчас для прохождения текущего теста.
- Никаких "на будущее".
- Никаких "а вдруг понадобится".
- Никаких "универсальных фабрик" для одного класса.

### 2. Last Responsible Moment
Принимай архитектурные решения (выбор БД, фреймворка, способа коммуникации) в самый последний момент, когда без этого решения уже нельзя двигаться дальше. Это сохраняет гибкость.

### 3. Дизайн через Рефакторинг (TDD Cycle)
Дизайн системы формируется на этапе **Refactor** цикла TDD (Red-Green-Refactor).
1. Написали тест (Red).
2. Написали минимальный код (Green).
3. **Увидели дублирование или сложность -> Рефакторинг (Design).**

### 4. 4 правила простого дизайна (Kent Beck)
В порядке приоритета:
1. **Passes the tests:** Система работает и проходит все тесты.
2. **Reveals intention:** Код понятен, имена говорят сами за себя (Self-documenting).
3. **No duplication (DRY):** Нет дублирования знаний/логики.
4. **Fewest elements:** Минимум классов, методов, модулей (удаляй лишнее).

## Практики

### Baby Steps
Делайте изменения максимально мелкими шагами.
- Написали тест -> Прошел -> Коммит.
- Переименовали переменную -> Коммит.
- Выделили метод -> Коммит.

Если шаг сломал систему и отладка занимает > 5 минут — **Revert** и попробуй меньший шаг.

### Parallel Change (Expand-Contract)
Как менять API/Базу данных без поломки системы:
1. **Expand:** Добавить новый метод/поле, не удаляя старый.
2. **Migrate:** Перевести клиентов на новый метод.
3. **Contract:** Удалить старый метод/поле.

### Strangler Fig Pattern
Для замены легаси систем:
1. Создать новый компонент рядом со старым.
2. Перенаправить часть трафика на новый компонент.
3. Постепенно "душить" старую систему, перенося функционал.